import{a as G}from"./chunk-ZJLCIVCJ.js";import{a as V}from"./chunk-DCM55A5P.js";import{a as re}from"./chunk-OOHQEE5L.js";import{d as te,e as ie}from"./chunk-WDDFHKIH.js";import{a as Z,b as ee}from"./chunk-NZNLV7ZF.js";import{a as Q,b as X}from"./chunk-AGVKSH7H.js";import{b as z,c as v,e as P,f as R,g as $,k as U,m as W,n as Y,o as H,q as J}from"./chunk-V2NMUT4R.js";import{a as j}from"./chunk-KEBJO4LJ.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as K}from"./chunk-PXM2JOVS.js";import"./chunk-27E65EIB.js";import{b as L,d as O}from"./chunk-67M3DXMG.js";import{h as k,j as B,n as D}from"./chunk-FYJ5Y7AH.js";import{Ab as T,Kb as l,Lb as x,Mb as S,Qa as o,Ra as c,Sb as A,Tb as N,Ub as M,Wb as q,ba as E,fb as _,hb as d,kb as F,mb as w,qb as i,rb as n,sb as g,zb as I}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var ae=()=>({width:"100%"}),C=r=>({"ng-invalid ng-dirty":r}),oe=(r,h,e)=>({"bg-green-100 border-green-400 text-green-700":r,"bg-red-100 border-red-400 text-red-700":h,"bg-yellow-100 border-yellow-400 text-yellow-700":e});function ne(r,h){if(r&1&&(i(0,"div",3)(1,"strong",22),l(2),n(),i(3,"span",23),l(4),n()()),r&2){let e=T();d("ngClass",q(3,oe,e.message.type==="success",e.message.type==="error",e.message.type==="warn")),o(2),x(e.message.type==="success"?"Success!":e.message.type==="error"?"Error!":"Warning!"),o(2),x(e.message.text)}}function le(r,h){r&1&&(i(0,"small",24),l(1,"Car Brand is required"),n())}function de(r,h){r&1&&(i(0,"small",24),l(1,"English Title is required"),n())}function se(r,h){r&1&&(i(0,"small",24),l(1,"Arabic Title is required"),n())}var we=(()=>{class r{constructor(e,a,t,s,m,u,p){this.fb=e,this.route=a,this.router=t,this.ngxSpinnerService=s,this.carModelsService=m,this.validationService=u,this.normalizeActiveStatusService=p,this.carBrands=[],this.dataSubscription=null,this.loading=!1,this.message={text:"",type:""},this.isEditMode=!1,this.carModelId=null,this.carModelForm=this.fb.group({car_brand_id:["",v.required],en_title:["",v.required],ar_title:["",v.required],active_status:[!0,v.required]})}ngOnInit(){this.carModelId=this.route.snapshot.paramMap.get("id"),this.isEditMode=!!this.carModelId,this.dataSubscription=this.route.data.subscribe({next:e=>{this.carBrands=e.data.carBrands||[],console.log(e),this.carBrands.length||(console.warn("No car brands received from resolver"),this.message={text:"No car brands available",type:"warn"},this.clearMessage()),this.isEditMode&&e.data.carModel&&this.carModelForm.patchValue({car_brand_id:e.data.carModel.car_brand_id,en_title:e.data.carModel.en_title,ar_title:e.data.carModel.ar_title,active_status:this.normalizeActiveStatusService.normalizeActiveStatus(e.data.carModel.active_status)}),this.ngxSpinnerService.hide("actionsLoader")},error:e=>{console.error("Failed to load data:",e),this.message={text:"Failed to load required data",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader")}}),this.ngxSpinnerService.hide("actionsLoader")}onSubmit(){if(this.carModelForm.invalid){this.markFormGroupTouched(this.carModelForm);return}this.loading=!0,this.message={text:"",type:""},this.ngxSpinnerService.show("actionsLoader");let e=this.carModelForm.value,a=new FormData;a.append("car_brand_id",e.car_brand_id),a.append("en_title",e.en_title),a.append("ar_title",e.ar_title),a.append("active_status",e.active_status?"1":"0"),(this.isEditMode&&this.carModelId?this.carModelsService.update(+this.carModelId,a):this.carModelsService.create(a)).subscribe({next:()=>{this.message={text:`Car model ${this.isEditMode?"updated":"created"} successfully`,type:"success"},this.router.navigate(["/dashboard/menu/car-models"]),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1,this.clearMessage()},error:s=>{console.error(`Error ${this.isEditMode?"updating":"creating"} car model:`,s),this.message={text:`Failed to ${this.isEditMode?"update":"create"} car model`,type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1}})}markFormGroupTouched(e){Object.values(e.controls).forEach(a=>{a.markAsTouched(),a instanceof $&&this.markFormGroupTouched(a)})}clearMessage(){setTimeout(()=>{this.message={text:"",type:""}},5e3)}ngOnDestroy(){this.dataSubscription&&this.dataSubscription.unsubscribe(),this.ngxSpinnerService.hide("actionsLoader")}static{this.\u0275fac=function(a){return new(a||r)(c(H),c(L),c(O),c(j),c(G),c(re),c(V))}}static{this.\u0275cmp=E({type:r,selectors:[["app-add-edit-car-models"]],standalone:!0,features:[A],decls:37,vars:23,consts:[[1,"py-8"],[1,"w-full","mb-4"],[1,"text-xl","font-semibold"],["role","alert",1,"border","px-4","py-3","rounded","relative","mb-4",3,"ngClass"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"flex","flex-col","sm:flex-row","gap-4","mb-6"],[1,"flex-1","w-full"],["for","car_brand_id",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],[1,"w-full"],["id","car_brand_id","formControlName","car_brand_id","optionLabel","en_title","optionValue","id","placeholder","Select Car Brand",1,"w-full",3,"options","showClear","ngClass"],[1,"h-6","mt-2"],["class","text-red-500 text-sm mx-4 block",4,"ngIf"],["for","en_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],["id","en_title","type","text","pInputText","","formControlName","en_title","placeholder","Enter English Title",1,"w-full","border","rounded","form-input",3,"ngClass"],["for","ar_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],["id","ar_title","type","text","pInputText","","formControlName","ar_title","placeholder","Enter Arabic Title",1,"w-full","border","rounded","form-input",3,"ngClass"],[1,"flex","gap-2","mx-4","items-center"],[1,"flex","gap-2","items-center"],["id","active_status","formControlName","active_status"],["for","active_status",1,"text-lg"],[1,"flex-1"],["type","submit",1,"px-4","py-2","bg-blue-500","text-white","rounded","text-xl","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"font-bold"],[1,"block","sm:inline","ml-2"],[1,"text-red-500","text-sm","mx-4","block"]],template:function(a,t){if(a&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),l(3),n()(),_(4,ne,5,7,"div",3),i(5,"form",4),I("ngSubmit",function(){return t.onSubmit()}),i(6,"div",5)(7,"div",6)(8,"label",7),l(9,"Car Brand"),n(),i(10,"div",8),g(11,"p-dropdown",9),i(12,"div",10),_(13,le,2,0,"small",11),n()()(),i(14,"div",6)(15,"label",12),l(16,"English Title"),n(),i(17,"div",8),g(18,"input",13),i(19,"div",10),_(20,de,2,0,"small",11),n()()(),i(21,"div",6)(22,"label",14),l(23,"Arabic Title"),n(),i(24,"div",8),g(25,"input",15),i(26,"div",10),_(27,se,2,0,"small",11),n()()()(),i(28,"div",16)(29,"div")(30,"div",17),g(31,"p-inputSwitch",18),i(32,"label",19),l(33),n()()(),g(34,"div",20),i(35,"button",21),l(36),n()()()()),a&2){let s,m,u,p,b,f,y;o(3),x(t.isEditMode?"Edit Car Model":"Add Car Model"),o(),w(4,t.message.text?4:-1),o(),d("formGroup",t.carModelForm),o(6),F(N(16,ae)),d("options",t.carBrands)("showClear",!1)("ngClass",M(17,C,((s=t.carModelForm.get("car_brand_id"))==null?null:s.invalid)&&((s=t.carModelForm.get("car_brand_id"))==null?null:s.touched))),o(2),d("ngIf",((m=t.carModelForm.get("car_brand_id"))==null?null:m.touched)&&((m=t.carModelForm.get("car_brand_id"))==null||m.errors==null?null:m.errors.required)),o(5),d("ngClass",M(19,C,((u=t.carModelForm.get("en_title"))==null?null:u.invalid)&&((u=t.carModelForm.get("en_title"))==null?null:u.touched))),o(2),d("ngIf",((p=t.carModelForm.get("en_title"))==null?null:p.touched)&&((p=t.carModelForm.get("en_title"))==null||p.errors==null?null:p.errors.required)),o(5),d("ngClass",M(21,C,((b=t.carModelForm.get("ar_title"))==null?null:b.invalid)&&((b=t.carModelForm.get("ar_title"))==null?null:b.touched))),o(2),d("ngIf",((f=t.carModelForm.get("ar_title"))==null?null:f.touched)&&((f=t.carModelForm.get("ar_title"))==null||f.errors==null?null:f.errors.required)),o(6),S(" ",(y=t.carModelForm.get("active_status"))!=null&&y.value?"Active":"Inactive"," "),o(2),d("disabled",t.loading||!t.carModelForm.valid),o(),S(" ",t.loading?"Loading...":t.isEditMode?"Update":"Submit"," ")}},dependencies:[D,k,B,J,U,z,P,R,W,Y,ie,te,X,Q,ee,Z,K],styles:["[_nghost-%COMP%]     .p-dropdown{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285)}[_nghost-%COMP%]     .p-dropdown .p-dropdown-label{font-size:16px;color:#6b7280;margin-top:1px}[_nghost-%COMP%]     .p-calendar{width:100%}[_nghost-%COMP%]     .p-calendar .p-inputtext{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285);font-size:16px}[_nghost-%COMP%]     .p-calendar .p-inputtext::placeholder{color:#6b7280}[_nghost-%COMP%]     .p-calendar .p-datepicker-trigger{background:transparent;border:none;position:absolute;right:10px;top:50%;transform:translateY(-50%);color:#6b7280}"]})}}return r})();export{we as AddEditCarModelsComponent};
