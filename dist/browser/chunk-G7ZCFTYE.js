import{a as Q}from"./chunk-RPKOAOYL.js";import{a as ee,b as te,c as ie,d as ne}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as re}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as X,e as Y}from"./chunk-WDDFHKIH.js";import{a as H,b as J}from"./chunk-NZNLV7ZF.js";import"./chunk-AGVKSH7H.js";import{e as G,j as U,p as Z}from"./chunk-V2NMUT4R.js";import{a as oe}from"./chunk-2O7EOZOI.js";import{a as N,c as B}from"./chunk-KEBJO4LJ.js";import{d as K,e as W}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{e as q,f as z}from"./chunk-PXM2JOVS.js";import{C as $,x as y}from"./chunk-27E65EIB.js";import{e as O}from"./chunk-67M3DXMG.js";import{n as R}from"./chunk-FYJ5Y7AH.js";import{Ab as c,Gb as A,Hb as D,Ib as I,Jb as C,Kb as d,Lb as w,Mb as T,Qa as l,Ra as E,Rb as j,Sb as M,Ub as b,Y as S,ba as V,fb as v,hb as h,ka as u,la as _,mb as P,mc as k,qb as s,rb as a,sb as p,wb as x,zb as f}from"./chunk-PSXZOWGB.js";import{a as F,b as L}from"./chunk-PSFXZ2QL.js";var se=["dt"],ae=r=>["/dashboard/menu/testimonials/edit",r],le=r=>["/dashboard/menu/testimonials/view",r];function me(r,g){if(r&1){let e=x();s(0,"tr")(1,"th",15),d(2," ID "),p(3,"p-sortIcon",16),a(),s(4,"th",17),d(5," Name"),p(6,"p-sortIcon",18),a(),s(7,"th",19),d(8," Professional"),p(9,"p-sortIcon",20),a(),s(10,"th",21),d(11," Created"),p(12,"p-sortIcon",22),a(),s(13,"th",23)(14,"p-dropdown",24,2),f("onChange",function(i){u(e);let n=C(15);return c(2).onFilterChange(i.value),_(n.showClear=!0)}),a()(),s(16,"th",23),d(17,"Actions"),a()()}if(r&2){let e=c(2);l(14),h("options",e.selectOptions)("showClear",!0)("autoZIndex",!0)}}function ce(r,g){if(r&1){let e=x();s(0,"tr")(1,"td",23),d(2),a(),s(3,"td",23)(4,"span",25),d(5),a()(),s(6,"td",23)(7,"span",25),d(8),a()(),s(9,"td",23),d(10),a(),s(11,"td",23)(12,"p-inputSwitch",26),f("onChange",function(){let i=u(e).$implicit,n=c(2);return _(n.toggleTestimonialStatus(i))}),a()(),s(13,"td",23)(14,"div",27)(15,"p-button",28),f("onClick",function(){u(e);let i=c(2);return _(i.runSpinner())}),a(),s(16,"p-button",29),f("onClick",function(){u(e);let i=c(2);return _(i.runSpinner())}),a()()()()}if(r&2){let e=g.$implicit,t=c(2);l(2),w(e.id),l(2),h("title",e.en_name),l(),T(" ",t.truncateText(e.en_name,30)," "),l(2),h("title",e.en_job),l(),T(" ",t.truncateText(e.en_job,30)," "),l(2),w(t.formatDate(e.created_at)),l(2),h("ngModel",e.active_status===1),l(3),h("routerLink",b(9,ae,e.id)),l(),h("routerLink",b(11,le,e.id))}}function de(r,g){r&1&&(s(0,"tr")(1,"td",30)(2,"div",31),p(3,"app-no-data-found-banner"),a()()())}function pe(r,g){if(r&1){let e=x();s(0,"div",3)(1,"div",4)(2,"h2",5),d(3,"Testimonials Control"),a(),p(4,"p-button",6),a(),s(5,"div",7)(6,"span",8),p(7,"i",9),s(8,"input",10,0),f("input",function(i){u(e);let n=C(11),o=c();return _(o.onGlobalFilter(n,i))}),a()()(),s(10,"p-table",11,1),f("onSort",function(i){u(e);let n=c();return _(n.onSort(i))})("onPage",function(i){u(e);let n=c();return _(n.onPageChange(i))}),v(12,me,18,3,"ng-template",12)(13,ce,17,13,"ng-template",13)(14,de,4,0,"ng-template",14),a()()}if(r&2){let e=c();l(10),h("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredTestimonials)}}function ue(r,g){r&1&&p(0,"app-loading-data-banner")}var Oe=(()=>{class r{ngOnInit(){this.initDropDownFilter(),this.fetchTestimonials(),this.ngxSpinnerService.hide("actionsLoader")}constructor(e){this.cdRef=e,this.ngxSpinnerService=S(N),this.messageService=S(y),this.testimonialsService=S(Q),this.isLoading=!1,this.testimonials=[],this.filteredTestimonials=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectOptions=[],this.sortField=null,this.sortOrder=1,this.currentPage=1}initDropDownFilter(){this.selectOptions=[{label:"Active",value:"1"},{label:"Inactive",value:"0"}]}fetchTestimonials(){this.ngxSpinnerService.show(),this.isLoading=!0,this.testimonialsService.getAll().subscribe({next:e=>{this.testimonials=e.data.map(t=>L(F({},t),{active_status:Number(t.active_status)})),this.applyFilters(),this.isLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load testimonials"}),this.isLoading=!1}})}applyFilters(){let e=[...this.testimonials];this.selectedStatus!==null&&this.selectedStatus!==""&&(e=e.filter(t=>t.active_status.toString()===this.selectedStatus)),this.sortField&&e.sort((t,i)=>this.compareValues(t,i,this.sortField,this.sortOrder)),this.filteredTestimonials=e,this.totalRecords=e.length}onGlobalFilter(e,t){let i=t.target.value.toLowerCase(),n=[...this.testimonials];this.selectedStatus!==null&&this.selectedStatus!==""&&(n=n.filter(o=>o.active_status.toString()===this.selectedStatus)),i&&(n=n.filter(o=>o.id.toString().includes(i)||o.en_name.toLowerCase().includes(i)||o.en_job.toLowerCase().includes(i)||(o.active_status?"active":"inactive").includes(i)||o.created_at.toLowerCase().includes(i))),this.sortField&&n.sort((o,m)=>this.compareValues(o,m,this.sortField,this.sortOrder)),this.filteredTestimonials=n,this.totalRecords=n.length}compareValues(e,t,i,n){let o,m;return i==="id"?(o=Number(e.id),m=Number(t.id)):i==="en_name"?(o=e.en_name,m=t.en_name):i==="en_job"?(o=e.en_job,m=t.en_job):i==="active_status"?(o=e.active_status,m=t.active_status):i==="created_at"||i==="updated_at"?(o=new Date(e[i]),m=new Date(t[i])):(o=e[i],m=t[i]),o==null?n*-1:m==null?n*1:o<m?n*-1:o>m?n*1:0}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}onSort(e){this.sortField=e.field,this.sortOrder=e.order,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1}toggleTestimonialStatus(e){this.ngxSpinnerService.show("actionsLoader"),this.messageService.clear(),(e.active_status===1?this.testimonialsService.disable(e.id):this.testimonialsService.enable(e.id)).subscribe({next:i=>{e.active_status=i.data.active_status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:i.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update testimonial status"}),this.ngxSpinnerService.hide("actionsLoader")}})}deleteTestimonial(e){confirm(`Are you sure you want to delete "${e.en_name}"?`)&&(this.ngxSpinnerService.show("actionsLoader"),this.testimonialsService.disable(e.id).subscribe({next:()=>{this.testimonials=this.testimonials.filter(t=>t.id!==e.id),this.applyFilters(),this.messageService.add({severity:"success",summary:"Deleted",detail:"Testimonial deleted successfully"}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to delete testimonial"}),this.ngxSpinnerService.hide("actionsLoader")}}))}getPagination(){return[10,25,50,100].sort((e,t)=>e-t)}runSpinner(){this.ngxSpinnerService.show("actionsLoader")}truncateText(e,t=50){return e.length>t?e.substring(0,t)+"...":e}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}static{this.\u0275fac=function(t){return new(t||r)(E(k))}}static{this.\u0275cmp=V({type:r,selectors:[["app-all-testimonials"]],viewQuery:function(t,i){if(t&1&&A(se,5),t&2){let n;D(n=I())&&(i.dt=n.first)}},standalone:!0,features:[j([y]),M],decls:3,vars:1,consts:[["search",""],["dt",""],["Dd",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],["routerLink","/dashboard/menu/testimonials/add","label","Add Testimonial","icon","pi pi-plus",1,"btn-main","text-white"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search testimonials...",1,"mb-0",3,"input"],["responsiveLayout","scroll",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","en_name",1,"text-center"],["field","en_name"],["pSortableColumn","en_job",1,"text-center"],["field","en_job"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],[1,"text-center"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Status",1,"mx-auto",3,"onChange","options","showClear","autoZIndex"],[3,"title"],[3,"onChange","ngModel"],[1,"flex","justify-center","gap-2"],["icon","pi pi-pencil","pTooltip","Edit Testimonial",1,"p-button-text","p-button-sm",3,"onClick","routerLink"],["icon","pi pi-eye","pTooltip","View Testimonial",1,"p-button-text","p-button-sm",3,"onClick","routerLink"],["colspan","8"],[1,"h-48","flex","justify-center","items-center","flex-col"]],template:function(t,i){t&1&&(p(0,"p-toast"),v(1,pe,15,6,"div",3)(2,ue,1,0)),t&2&&(l(),P(1,i.isLoading?2:1))},dependencies:[z,q,$,Y,X,J,H,ne,ee,te,ie,W,K,O,oe,re,R,Z,G,U,B]})}}return r})();export{Oe as AllTestimonialsComponent};
