import{a as z}from"./chunk-FVKKPNZF.js";import{a as te,b as ne,c as ie,d as oe}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as ae}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as Y,e as ee}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{p as H}from"./chunk-V2NMUT4R.js";import{a as re}from"./chunk-2O7EOZOI.js";import{a as Q,c as Z}from"./chunk-KEBJO4LJ.js";import{d as W,e as X}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as K}from"./chunk-PXM2JOVS.js";import{C as U,x as y}from"./chunk-27E65EIB.js";import{b as B,e as G}from"./chunk-67M3DXMG.js";import{h as N,n as $}from"./chunk-FYJ5Y7AH.js";import{$a as M,Ab as h,Gb as F,Hb as I,Ib as L,Jb as j,Kb as l,Lb as u,Mb as A,Qa as a,Rb as D,Sb as V,Tb as J,Ub as v,Y as f,ba as T,f as P,fb as S,hb as _,ka as x,la as b,lb as g,mb as E,mc as k,qb as i,rb as o,sb as c,wb as w,z as O,zb as C}from"./chunk-PSXZOWGB.js";import{a as q,b as R}from"./chunk-PSFXZ2QL.js";var se=["dt"],le=()=>({"min-width":"80rem"}),ce=r=>["/dashboard/menu/jop-request/comments",r],pe=r=>["/dashboard/menu/jop-requests/edit",r],de=r=>["/dashboard/menu/jop-requests/view",r];function ue(r,m){r&1&&c(0,"app-loading-data-banner")}function me(r,m){if(r&1&&(i(0,"div",36),c(1,"i",37),i(2,"span"),l(3),o()()),r&2){let e=m.$implicit;a(),g(e.icon+" "+e.color),a(),g(e.color),a(),u(e.label)}}function he(r,m){if(r&1&&(i(0,"div",36),c(1,"i",37),i(2,"span"),l(3),o()()),r&2){let e=m.$implicit;a(),g(e.icon+" "+e.color),a(),g(e.color),a(),u(e.label)}}function _e(r,m){if(r&1){let e=w();i(0,"tr",14)(1,"th",15),l(2," ID "),c(3,"p-sortIcon",16),o(),i(4,"th",17),l(5," Name "),c(6,"p-sortIcon",18),o(),i(7,"th",19),l(8," Email "),c(9,"p-sortIcon",20),o(),i(10,"th",21),l(11," Phone "),c(12,"p-sortIcon",22),o(),i(13,"th",14)(14,"p-dropdown",23,1),C("onChange",function(n){x(e);let s=j(15);return h(2).onRequestTypeFilterChange(n.value),b(s.showClear=!0)}),o()(),i(16,"th",24),l(17," Professional Title "),c(18,"p-sortIcon",25),o(),i(19,"th",26),l(20," professional Price "),c(21,"p-sortIcon",27),o(),i(22,"th",28),l(23," professional Insurance Number "),c(24,"p-sortIcon",29),o(),i(25,"th",30),l(26," Created "),c(27,"p-sortIcon",31),o(),i(28,"th",14),l(29,"Comments"),o(),i(30,"th",32)(31,"p-dropdown",33),C("onChange",function(n){x(e);let s=h(2);return b(s.onFilterChange(n.value))}),S(32,me,4,5,"ng-template",34)(33,he,4,5,"ng-template",35),o()(),i(34,"th",14),l(35,"Actions"),o()()}if(r&2){let e=h(2);a(14),_("options",e.requestTypeOptions)("showClear",!0)("autoZIndex",!0),a(17),_("options",e.selectOptions)("showClear",!0)("autoZIndex",!0)}}function ge(r,m){if(r&1&&(i(0,"tr",14)(1,"td"),l(2),o(),i(3,"td"),l(4),o(),i(5,"td"),l(6),o(),i(7,"td"),l(8),o(),i(9,"td"),l(10),o(),i(11,"td"),l(12),o(),i(13,"td"),l(14),o(),i(15,"td"),l(16),o(),i(17,"td"),l(18),o(),i(19,"td")(20,"a",38),c(21,"i",39),o()(),i(22,"td",40)(23,"div",41),c(24,"i",37),i(25,"span"),l(26),o()()(),i(27,"td")(28,"div",42)(29,"a",38),c(30,"i",43),o(),i(31,"a",38),c(32,"i",44),o()()()()),r&2){let e=m.$implicit,t=h(2);a(2),u(e.id),a(2),u(e.name),a(2),u(e.email),a(2),u(e.phone),a(2),u(e.request_type||"individual"),a(2),u(e.jop_title),a(2),u(e.jop_price||e.company_employee_total_money),a(2),u(e.jop_insurance_number),a(2),u(t.formatDate(e.created_at)),a(2),_("routerLink",v(18,ce,e.id)),a(2),_("ngClass",t.getStatusClass(e.active_status)),a(2),g(t.getStatusIcon(e.active_status)+" "+t.getStatusColor(e.active_status)),a(),g(t.getStatusColor(e.active_status)),a(),A(" ",t.getStatusLabel(e.active_status)," "),a(3),_("routerLink",v(20,pe,e.id)),a(2),_("routerLink",v(22,de,e.id))}}function fe(r,m){r&1&&(i(0,"tr",14)(1,"td",45),c(2,"app-no-data-found-banner"),o()())}function xe(r,m){if(r&1){let e=w();i(0,"div",2)(1,"div",3)(2,"h2",4),l(3,"Professional Requests"),o()(),i(4,"div",5)(5,"span",6),c(6,"i",7),i(7,"input",8),C("input",function(n){x(e);let s=h();return b(s.onGlobalFilter(n))}),o()()(),i(8,"div",9)(9,"p-table",10,0),C("onSort",function(n){x(e);let s=h();return b(s.onSort(n))})("onPage",function(n){x(e);let s=h();return b(s.onPageChange(n))}),S(11,_e,36,6,"ng-template",11)(12,ge,33,24,"ng-template",12)(13,fe,3,0,"ng-template",13),o()()()}if(r&2){let e=h();a(9),_("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredRequests)("tableStyle",J(8,le))("sortMode","multiple")}}var Ne=(()=>{class r{constructor(){this.ngxSpinnerService=f(Q),this.messageService=f(y),this.jobRequestsService=f(z),this.route=f(B),this.cdRef=f(k),this.isLoading=M(!1),this.requests=[],this.filteredRequests=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectedRequestType=null,this.requestTypeOptions=[],this.statusSteps=["requested","pending","confirmed","canceled"],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.selectOptions=[],this.searchSubject=new P}ngOnInit(){this.initDropDownFilter(),this.isLoading.set(!0);let e=this.route.snapshot.data.data;this.isLoading.set(!1),e&&e.data&&Array.isArray(e.data)?(this.requests=e.data.sort((t,n)=>new Date(n.created_at).getTime()-new Date(t.created_at).getTime()),this.initRequestTypeOptions(),this.applyFilters()):(this.requests=[],this.filteredRequests=[],this.totalRecords=0),this.ngxSpinnerService.hide("actionsLoader"),this.setupSearchDebounce()}setupSearchDebounce(){this.searchSubject.pipe(O(300)).subscribe(e=>{this.applyGlobalFilter(e)})}initDropDownFilter(){this.selectOptions=[{label:"Requested",value:"requested",icon:"pi pi-inbox",color:"text-blue-600"},{label:"Pending",value:"pending",icon:"pi pi-clock",color:"text-yellow-600"},{label:"Confirmed",value:"confirmed",icon:"pi pi-check-circle",color:"text-green-600"},{label:"Canceled",value:"canceled",icon:"pi pi-times-circle",color:"text-red-600"}]}initRequestTypeOptions(){let e=[...new Set(this.requests.map(t=>t.request_type||"individual"))];this.requestTypeOptions=e.map(t=>({label:t.charAt(0).toUpperCase()+t.slice(1),value:t}))}getStatusClass(e){switch(e){case"confirmed":return"bg-green-200 text-green-800";case"canceled":return"bg-red-200 text-red-800";case"pending":return"bg-yellow-200 text-yellow-800";case"requested":return"bg-blue-200 text-blue-800";default:return""}}getAvailableStatusOptions(e){let t=this.statusSteps.indexOf(e);return this.selectOptions.filter(n=>!(e==="confirmed"&&n.value==="canceled")).map((n,s)=>R(q({},n),{disabled:s<t}))}applyFilters(){let e=[...this.requests];this.selectedStatus!==null&&(e=e.filter(t=>t.active_status===this.selectedStatus)),this.selectedRequestType!==null&&(e=e.filter(t=>(t.request_type||"individual")===this.selectedRequestType)),this.sortField&&e.sort((t,n)=>this.compareValues(t,n,this.sortField,this.sortOrder)),this.filteredRequests=e,this.totalRecords=e.length}onGlobalFilter(e){let n=e.target.value.trim().toLowerCase();this.searchSubject.next(n)}applyGlobalFilter(e){let t=[...this.requests];this.selectedStatus!==null&&(t=t.filter(n=>n.active_status===this.selectedStatus)),this.selectedRequestType!==null&&(t=t.filter(n=>(n.request_type||"individual")===this.selectedRequestType)),e&&(t=t.filter(n=>(n.id?.toString().toLowerCase()||"").includes(e)||(n.name?.toLowerCase()||"").includes(e)||(n.email?.toLowerCase()||"").includes(e)||(n.phone?.toString().toLowerCase()||"").includes(e)||(n.active_status?.toLowerCase()||"").includes(e)||(n.job_title?.toLowerCase()||"").includes(e)||(n.company_name?.toLowerCase()||"").includes(e)||(n.profession_name?.toLowerCase()||"").includes(e)||(n.request_type?.toLowerCase()||"").includes(e))),this.sortField&&t.sort((n,s)=>this.compareValues(n,s,this.sortField,this.sortOrder)),this.filteredRequests=t,this.totalRecords=t.length,this.dt&&(this.dt.first=0),this.currentPage=1,this.cdRef.detectChanges()}compareValues(e,t,n,s){if(!n)return 0;let p=e[n],d=t[n];return n==="id"||n==="phone"||n==="years_of_experience"?(p=p?Number(p):null,d=d?Number(d):null):n==="created_at"||n==="updated_at"||n==="start_date"||n==="end_date"?(p=p?new Date(p):null,d=d?new Date(d):null):(p=p?p.toString().toLowerCase():"",d=d?d.toString().toLowerCase():""),p==null||p===""?s*-1:d==null||d===""?s*1:p<d?s*-1:p>d?s*1:0}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}onRequestTypeFilterChange(e){this.selectedRequestType=e,this.applyFilters()}onSort(e){let{field:t}=e.multisortmeta[0];this.sortField=t,this.sortOrder=t,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1}updateRequestStatus(e,t){this.ngxSpinnerService.show("actionsLoader"),(t==="canceled"?this.jobRequestsService.cancel(e.id):this.jobRequestsService.changeStatus(e.id,t)).subscribe({next:s=>{e.active_status=s.data.active_status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:s.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update request status"}),this.ngxSpinnerService.hide("actionsLoader")}})}getPagination(){let e=this.filteredRequests.length;return[10,25,50,100,e].filter(t=>t<=e)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}getStatusLabel(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.label:e}getStatusIcon(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.icon:""}getStatusColor(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.color:""}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=T({type:r,selectors:[["app-all-jop-requests"]],viewQuery:function(t,n){if(t&1&&F(se,5),t&2){let s;I(s=L())&&(n.dt=s.first)}},standalone:!0,features:[D([y]),V],decls:3,vars:1,consts:[["dt",""],["requestTypeFilter",""],[1,"card","overflow-x-auto"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-content-end","gap-3"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search requests...",3,"input"],[1,"overflow-x-auto"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","tableStyle","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","email",1,"text-center"],["field","email"],["pSortableColumn","phone",1,"text-center"],["field","phone"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Request Type",1,"mx-auto","max-w-[120px]",3,"onChange","options","showClear","autoZIndex"],["pSortableColumn","job_title",1,"text-center"],["field","job_title"],["pSortableColumn","company_name",1,"text-center"],["field","company_name"],["pSortableColumn","profession_name",1,"text-center"],["field","profession_name"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],["pSortableColumn","active_status",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Status",3,"onChange","options","showClear","autoZIndex"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"flex","items-center","justify-center"],[1,"mr-2"],[3,"routerLink"],[1,"pi","pi-comments"],[3,"ngClass"],[1,"flex","items-center","justify-center","border","rounded","px-2","bg-white","py-3"],[1,"flex","gap-2","items-center","justify-center"],[1,"pi","pi-pencil"],[1,"pi","pi-eye"],["colspan","11"]],template:function(t,n){t&1&&(c(0,"p-toast"),S(1,ue,1,0,"app-loading-data-banner")(2,xe,14,9)),t&2&&(a(),E(1,n.isLoading()?1:2))},dependencies:[K,U,ee,Y,oe,te,ne,ie,X,W,G,re,ae,$,N,H,Z],styles:[".card[_ngcontent-%COMP%]{padding:1.5rem;border-radius:8px;background:#fff;box-shadow:0 2px 4px #0000001a}  .status-dropdown .p-dropdown{border:none!important;background:transparent!important}  .status-dropdown .p-dropdown .p-dropdown-label{padding:.25rem .5rem;font-size:.875rem}  .p-table .p-table-header-cell{background-color:#f8fafc;border-bottom:2px solid #e5e7eb;font-weight:600;color:#374151}  .p-table .p-table-row:hover{background-color:#f9fafb}  .p-table .p-table-body-cell{padding:.75rem;border-bottom:1px solid #e5e7eb}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{padding-right:2.5rem;border-radius:6px;border:1px solid #d1d5db}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:#6b7280}.bg-green-200[_ngcontent-%COMP%]{background-color:#dcfce7}.text-green-800[_ngcontent-%COMP%]{color:#166534}.bg-red-200[_ngcontent-%COMP%]{background-color:#fecaca}.text-red-800[_ngcontent-%COMP%]{color:#991b1b}.bg-yellow-200[_ngcontent-%COMP%]{background-color:#fef3c7}.text-yellow-800[_ngcontent-%COMP%]{color:#92400e}.bg-blue-200[_ngcontent-%COMP%]{background-color:#dbeafe}.text-blue-800[_ngcontent-%COMP%]{color:#1e40af}.pi-eye[_ngcontent-%COMP%], .pi-pencil[_ngcontent-%COMP%], .pi-comments[_ngcontent-%COMP%]{font-size:1.1rem;color:#6b7280;transition:color .2s ease}.pi-eye[_ngcontent-%COMP%]:hover, .pi-pencil[_ngcontent-%COMP%]:hover, .pi-comments[_ngcontent-%COMP%]:hover{color:#3b82f6}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}@media (max-width: 1024px){.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:scroll}}"]})}}return r})();export{Ne as AllJopRequestsComponent};
