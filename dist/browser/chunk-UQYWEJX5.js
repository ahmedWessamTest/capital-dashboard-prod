import{a as J}from"./chunk-YNPVSSEO.js";import{a as le,b as re,c as se,d as pe}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as de}from"./chunk-Y6SZKX5H.js";import{b as ne}from"./chunk-4WY6IZPL.js";import{d as oe,e as ae}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{e as K,j as X,p as Y}from"./chunk-V2NMUT4R.js";import{a as me}from"./chunk-2O7EOZOI.js";import{a as U,c as z}from"./chunk-KEBJO4LJ.js";import{d as te,e as ie}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as ee}from"./chunk-PXM2JOVS.js";import{C as H,x as M}from"./chunk-27E65EIB.js";import{b as W,e as G}from"./chunk-67M3DXMG.js";import{h as B,n as Q}from"./chunk-FYJ5Y7AH.js";import{$a as A,Ab as _,Gb as V,Hb as D,Ib as O,Jb as R,Kb as m,Lb as u,Ob as N,Pb as $,Qa as l,Qb as j,Ra as I,Rb as k,Sb as Z,Tb as w,Ub as b,Y as v,ba as E,fb as x,hb as C,ka as g,kb as L,la as f,lb as h,mb as P,mc as q,qb as a,rb as r,sb as c,wb as y,zb as S}from"./chunk-PSXZOWGB.js";import{a as T,b as F}from"./chunk-PSFXZ2QL.js";var ue=["dt"],_e=()=>({"min-width":"70rem"}),Ce=t=>["/dashboard/menu/motor-claims/comments",t],he=()=>({width:"100%"}),ge=t=>["/dashboard/menu/motor-claims/view-motor-claim",t];function fe(t,d){t&1&&c(0,"app-loading-data-banner")}function xe(t,d){if(t&1&&(a(0,"div",30),c(1,"i",31),a(2,"span"),m(3),r()()),t&2){let e=d.$implicit;l(),h(e.icon+" "+e.color),l(),h(e.color),l(),u(e.label)}}function Se(t,d){if(t&1&&(a(0,"div",30),c(1,"i",31),a(2,"span"),m(3),r()()),t&2){let e=d.$implicit;l(),h(e.icon+" "+e.color),l(),h(e.color),l(),u(e.label)}}function ve(t,d){if(t&1&&(a(0,"span"),m(1),r()),t&2){let e=d.$implicit;l(),u(e.label)}}function ye(t,d){if(t&1&&(a(0,"span"),m(1),r()),t&2){let e=d.$implicit;l(),u(e.label)}}function we(t,d){if(t&1){let e=y();a(0,"tr",13)(1,"th",14),m(2," ID "),c(3,"p-sortIcon",15),r(),a(4,"th",16),m(5," Name "),c(6,"p-sortIcon",17),r(),a(7,"th",18),m(8," Email "),c(9,"p-sortIcon",19),r(),a(10,"th",20),m(11," Phone "),c(12,"p-sortIcon",21),r(),a(13,"th",22),m(14," Created "),c(15,"p-sortIcon",23),r(),a(16,"th",13),m(17,"Comments"),r(),a(18,"th",24)(19,"p-dropdown",25),S("onChange",function(n){g(e);let o=_(2);return f(o.onFilterChange(n.value))}),x(20,xe,4,5,"ng-template",26)(21,Se,4,5,"ng-template",27),r()(),a(22,"th",28)(23,"p-dropdown",29),S("onChange",function(n){g(e);let o=_(2);return f(o.onTypeFilterChange(n.value))}),x(24,ve,2,1,"ng-template",26)(25,ye,2,1,"ng-template",27),r()(),a(26,"th",13),m(27,"Actions"),r()()}if(t&2){let e=_(2);l(19),C("options",e.selectOptions)("showClear",!0)("autoZIndex",!0),l(4),C("options",e.typeOptions)("showClear",!0)("autoZIndex",!0)}}function be(t,d){if(t&1&&(a(0,"div",30),c(1,"i",31),a(2,"span"),m(3),r()()),t&2){let e=d.$implicit;l(),h(e.icon+" "+e.color),l(),h(e.color),l(),u(e.label)}}function Me(t,d){if(t&1&&(a(0,"div",30),c(1,"i",31),a(2,"span"),m(3),r()()),t&2){let e=d.$implicit;l(),h(e.icon+" "+e.color),l(),h(e.color),l(),u(e.label)}}function Te(t,d){if(t&1){let e=y();a(0,"tr",13)(1,"td"),m(2),r(),a(3,"td"),m(4),r(),a(5,"td"),m(6),r(),a(7,"td"),m(8),r(),a(9,"td"),m(10),r(),a(11,"td")(12,"a",32),c(13,"i",33),r()(),a(14,"td",34)(15,"p-dropdown",35),j("ngModelChange",function(n){let o=g(e).$implicit;return $(o.status,n)||(o.status=n),f(n)}),S("onChange",function(n){let o=g(e).$implicit,p=_(2);return f(p.updateClaimStatus(o,n.value))}),x(16,be,4,5,"ng-template",26)(17,Me,4,5,"ng-template",27),r()(),a(18,"td"),m(19),r(),a(20,"td")(21,"div",36)(22,"a",32),c(23,"i",37),r()()()()}if(t&2){let e=d.$implicit,i=_(2);l(2),u(e.id),l(2),u(e.name),l(2),u(e.email),l(2),u(e.phone),l(2),u(i.formatDate(e.created_at)),l(2),C("routerLink",b(15,Ce,e.id)),l(2),C("ngClass",i.getStatusClass(e.status)),l(),L(w(17,he)),C("options",i.getAvailableStatusOptions(e.status)),N("ngModel",e.status),C("autoZIndex",!0)("appendTo","body"),l(4),u(i.getClaimType(e)),l(3),C("routerLink",b(18,ge,e.id))}}function Fe(t,d){t&1&&(a(0,"tr",13)(1,"td",38),c(2,"app-no-data-found-banner"),r()())}function Ee(t,d){if(t&1){let e=y();a(0,"div",1)(1,"div",2)(2,"h2",3),m(3,"Motor Claims"),r()(),a(4,"div",4)(5,"span",5),c(6,"i",6),a(7,"input",7),S("input",function(n){g(e);let o=R(10),p=_();return f(p.onGlobalFilter(o,n))}),r()()(),a(8,"div",8)(9,"p-table",9,0),S("onSort",function(n){g(e);let o=_();return f(o.onSort(n))})("onPage",function(n){g(e);let o=_();return f(o.onPageChange(n))}),x(11,we,28,6,"ng-template",10)(12,Te,24,20,"ng-template",11)(13,Fe,3,0,"ng-template",12),r()()()}if(t&2){let e=_();l(9),C("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredClaims)("tableStyle",w(8,_e))("sortMode","multiple")}}var Xe=(()=>{class t{ngOnInit(){this.initDropDownFilter(),this.initTypeFilter(),this.isLoading.set(!0),this.claims=this.route.snapshot.data.data?.data||[],this.isLoading.set(!1),this.applyFilters(),this.ngxSpinnerService.hide("actionsLoader")}ngAfterViewInit(){console.log("Table reference:",this.dt)}constructor(e){this.cdRef=e,this.ngxSpinnerService=v(U),this.messageService=v(M),this.motorClaimsService=v(J),this.route=v(W),this.claims=[],this.isLoading=A(!1),this.filteredClaims=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectedType=null,this.statusSteps=["requested","pending","confirmed","canceled"],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.selectOptions=[],this.typeOptions=[]}initDropDownFilter(){this.selectOptions=[{label:"Requested",value:"requested",icon:"pi pi-inbox",color:"text-blue-600"},{label:"Pending",value:"pending",icon:"pi pi-clock",color:"text-yellow-600"},{label:"Confirmed",value:"confirmed",icon:"pi pi-check-circle",color:"text-green-600"},{label:"Canceled",value:"canceled",icon:"pi pi-times-circle",color:"text-red-600"}]}initTypeFilter(){this.typeOptions=[{label:"Manual",value:"manual"},{label:"Ordinary",value:"ordinary"}]}getStatusClass(e){switch(e){case"confirmed":return"bg-green-200 text-green-800";case"canceled":return"bg-red-200 text-red-800";case"pending":return"bg-yellow-200 text-yellow-800";case"requested":return"bg-blue-200 text-blue-800";default:return""}}getClaimType(e){return e.motor_insurance_id?"Ordinary":"Manual"}getAvailableStatusOptions(e){let i=this.statusSteps.indexOf(e);return this.selectOptions.filter(n=>!(e==="confirmed"&&n.value==="canceled")).map((n,o)=>F(T({},n),{disabled:o<i}))}applyFilters(){let e=[...this.claims];this.selectedStatus!==null&&(e=e.filter(i=>i.status===this.selectedStatus)),this.selectedType!==null&&(e=e.filter(i=>this.selectedType==="manual"?i.motor_insurance_id===null:i.motor_insurance_id!==null)),this.sortField&&e.sort((i,n)=>this.compareValues(i,n,this.sortField,this.sortOrder)),this.filteredClaims=e,this.totalRecords=e.length}onGlobalFilter(e,i){let o=i.target.value.toLowerCase(),p=[...this.claims];this.selectedStatus!==null&&(p=p.filter(s=>s.status===this.selectedStatus)),this.selectedType!==null&&(p=p.filter(s=>this.selectedType==="manual"?s.motor_insurance_id===null:s.motor_insurance_id!==null)),o&&(p=p.filter(s=>s.id.toString().includes(o)||s.name.toLowerCase().includes(o)||s.email&&s.email.toLowerCase().includes(o)||s.phone&&s.phone.includes(o)||s.status.toLowerCase().includes(o)||this.getClaimType(s).toLowerCase().includes(o))),this.sortField&&p.sort((s,ce)=>this.compareValues(s,ce,this.sortField,this.sortOrder)),this.filteredClaims=p,this.totalRecords=p.length}compareValues(e,i,n,o){if(!n)return 0;let p=e[n],s=i[n];return n==="id"?(p=Number(p),s=Number(s)):n==="created_at"||n==="updated_at"?(p=new Date(p),s=new Date(s)):n==="type"&&(p=this.getClaimType(e),s=this.getClaimType(i)),p==null?o*-1:s==null?o*1:p<s?o*-1:p>s?o*1:0}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}onTypeFilterChange(e){this.selectedType=e,this.applyFilters()}onSort(e){this.sortField=e.field,this.sortOrder=e.order,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1}updateClaimStatus(e,i){this.ngxSpinnerService.show("actionsLoader");let n=new FormData;n.append("status",i),this.motorClaimsService.update(e.id,n).subscribe({next:o=>{e.status=o.data.status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:o.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update claim status"}),this.ngxSpinnerService.hide("actionsLoader")}})}getPagination(){let e=this.filteredClaims.length;return[10,25,50,100,e].filter(i=>i<=e)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}static{this.\u0275fac=function(i){return new(i||t)(I(q))}}static{this.\u0275cmp=E({type:t,selectors:[["app-all-motor-claims"]],viewQuery:function(i,n){if(i&1&&V(ue,5),i&2){let o;D(o=O())&&(n.dt=o.first)}},standalone:!0,features:[k([M]),Z],decls:3,vars:1,consts:[["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-content-end","gap-3"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search claims...",3,"input"],[1,"overflow-x-auto"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","tableStyle","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","email",1,"text-center"],["field","email"],["pSortableColumn","phone",1,"text-center"],["field","phone"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],["pSortableColumn","status",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Status",3,"onChange","options","showClear","autoZIndex"],["pTemplate","selectedItem"],["pTemplate","item"],["pSortableColumn","type",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Type",3,"onChange","options","showClear","autoZIndex"],[1,"flex","items-center","justify-center"],[1,"mr-2"],[3,"routerLink"],[1,"pi","pi-comments"],[3,"ngClass"],["optionLabel","label","optionValue","value","styleClass","status-dropdown",3,"ngModelChange","onChange","options","ngModel","autoZIndex","appendTo"],[1,"flex","gap-2","items-center","justify-center"],[1,"pi","pi-eye"],["colspan","9"]],template:function(i,n){i&1&&(c(0,"p-toast"),x(1,fe,1,0,"app-loading-data-banner")(2,Ee,14,9)),i&2&&(l(),P(1,n.isLoading()?1:2))},dependencies:[ee,H,ae,oe,pe,le,re,se,ie,te,G,me,de,Q,B,Y,K,X,z,ne]})}}return t})();export{Xe as AllMotorsClaimsComponent};
