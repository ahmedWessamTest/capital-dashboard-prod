import{a as E}from"./chunk-V2A3WW6V.js";import{a as R}from"./chunk-DCM55A5P.js";import{a as K,b as Q,c as U,d as X}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as ee}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as H,e as J}from"./chunk-WDDFHKIH.js";import{a as N,b as j}from"./chunk-NZNLV7ZF.js";import"./chunk-AGVKSH7H.js";import{e as B,j as W,p as z}from"./chunk-V2NMUT4R.js";import{a as $}from"./chunk-2O7EOZOI.js";import{a as D}from"./chunk-KEBJO4LJ.js";import{d as q,e as G}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{e as Z,f as k}from"./chunk-PXM2JOVS.js";import{C as L,x as S}from"./chunk-27E65EIB.js";import{b as I,d as O,e as Y}from"./chunk-67M3DXMG.js";import{n as V}from"./chunk-FYJ5Y7AH.js";import{Ab as s,Kb as u,Lb as g,Ob as C,Pb as w,Qa as l,Qb as f,Rb as F,Sb as T,Ub as A,Y as _,ba as M,fb as b,hb as c,ka as d,la as p,mb as P,qb as o,rb as r,sb as h,wb as v,zb as m}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var te=a=>["/dashboard/menu/car-years/edit",a];function ie(a,x){if(a&1){let e=v();o(0,"tr")(1,"th",15),u(2," ID "),h(3,"p-sortIcon",16),r(),o(4,"th",17)(5,"p-dropdown",18),f("ngModelChange",function(t){d(e);let i=s(2);return w(i.activeFilters.year,t)||(i.activeFilters.year=t),p(t)}),m("onChange",function(t){d(e);let i=s(2);return p(i.onFilterChange("year",t.value))}),r()(),o(6,"th",19)(7,"p-dropdown",20),f("ngModelChange",function(t){d(e);let i=s(2);return w(i.activeFilters.model,t)||(i.activeFilters.model=t),p(t)}),m("onChange",function(t){d(e);let i=s(2);return p(i.onFilterChange("model",t.value))}),r()(),o(8,"th",19)(9,"p-dropdown",21),f("ngModelChange",function(t){d(e);let i=s(2);return w(i.activeFilters.brand,t)||(i.activeFilters.brand=t),p(t)}),m("onChange",function(t){d(e);let i=s(2);return p(i.onFilterChange("brand",t.value))}),r()(),o(10,"th",19)(11,"p-dropdown",22),f("ngModelChange",function(t){d(e);let i=s(2);return w(i.activeFilters.type,t)||(i.activeFilters.type=t),p(t)}),m("onChange",function(t){d(e);let i=s(2);return p(i.onFilterChange("type",t.value))}),r()(),o(12,"th",19)(13,"p-dropdown",23),f("ngModelChange",function(t){d(e);let i=s(2);return w(i.activeFilters.status,t)||(i.activeFilters.status=t),p(t)}),m("onChange",function(t){d(e);let i=s(2);return p(i.onFilterChange("status",t.value))}),r()(),o(14,"th",24),u(15,"Actions"),r()()}if(a&2){let e=s(2);l(5),c("options",e.yearOptions),C("ngModel",e.activeFilters.year),c("showClear",!0)("autoZIndex",!0)("dropdownIcon","pi pi-filter"),l(2),c("options",e.modelOptions),C("ngModel",e.activeFilters.model),c("showClear",!0)("autoZIndex",!0)("dropdownIcon","pi pi-filter"),l(2),c("options",e.brandOptions),C("ngModel",e.activeFilters.brand),c("showClear",!0)("autoZIndex",!0)("dropdownIcon","pi pi-filter"),l(2),c("options",e.typeOptions),C("ngModel",e.activeFilters.type),c("showClear",!0)("autoZIndex",!0)("dropdownIcon","pi pi-filter"),l(2),c("options",e.statusOptions),C("ngModel",e.activeFilters.status),c("showClear",!0)("autoZIndex",!0)("dropdownIcon","pi pi-filter")}}function ne(a,x){if(a&1){let e=v();o(0,"tr")(1,"td",25),u(2),r(),o(3,"td",25),u(4),r(),o(5,"td",25),u(6),r(),o(7,"td",25),u(8),r(),o(9,"td",25),u(10),r(),o(11,"td",25)(12,"p-inputSwitch",26),m("onChange",function(){let t=d(e).$implicit,i=s(2);return p(i.toggleStatus(t))}),r()(),o(13,"td",25),h(14,"p-button",27),r()()}if(a&2){let e=x.$implicit,n=s(2);l(2),g(e.id),l(2),g(e.year_date),l(2),g(e.car_model_title),l(2),g(e.car_brand_title),l(2),g(e.car_type_title),l(2),c("ngModel",n.normalizeActiveStatus.normalizeActiveStatus(e.active_status)),l(2),c("routerLink",A(7,te,e.id))}}function oe(a,x){a&1&&(o(0,"tr")(1,"td",28),h(2,"app-no-data-found-banner"),r()())}function re(a,x){if(a&1){let e=v();o(0,"div",2)(1,"div",3)(2,"h2",4),u(3,"Car Years Control"),r(),h(4,"p-button",5),r(),o(5,"div",6)(6,"span",7),h(7,"i",8),o(8,"input",9,0),m("input",function(t){d(e);let i=s();return p(i.onGlobalFilter(t))}),r()()(),o(10,"div",10)(11,"p-table",11,1),m("onPage",function(t){d(e);let i=s();return p(i.onPageChange(t))}),b(13,ie,16,25,"ng-template",12)(14,ne,15,9,"ng-template",13)(15,oe,3,0,"ng-template",14),r()()()}if(a&2){let e=s();l(11),c("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredData)("scrollable",!0)}}function ae(a,x){a&1&&h(0,"app-loading-data-banner")}var Ie=(()=>{class a{constructor(){this.combinedData=[],this.filteredData=[],this.carTypes=[],this.carBrands=[],this.carModels=[],this.yearOptions=[],this.modelOptions=[],this.brandOptions=[],this.typeOptions=[],this.statusOptions=[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],this.activeFilters={year:null,model:null,brand:null,type:null,status:null},this.totalRecords=0,this.rowsPerPage=10,this.currentPage=1,this.searchTerm="",this.first=0,this.carYearsService=_(E),this.normalizeActiveStatus=_(R),this.spinner=_(D),this.messageService=_(S),this.router=_(O),this.route=_(I)}ngOnInit(){this.route.data.subscribe({next:e=>{console.log(e.data),this.combinedData=e.data.combinedData,this.carTypes=e.data.carTypes,this.carBrands=e.data.carBrands,this.carModels=e.data.carModels,this.filteredData=[...this.combinedData],this.totalRecords=this.combinedData.length,this.initFilterOptions(),this.spinner.hide("actionsLoader")},error:()=>{this.showError("Failed to load data"),this.spinner.hide("actionsLoader")}})}initFilterOptions(){this.yearOptions=this.getDistinctOptions(this.combinedData,"year_date"),this.modelOptions=this.carModels.map(e=>({label:e.en_title,value:e.id})),this.brandOptions=this.carBrands.map(e=>({label:e.en_title,value:e.id})),this.typeOptions=this.carTypes.map(e=>({label:e.en_title,value:e.id}))}getDistinctOptions(e,n){return[...new Set(e.map(i=>i[n]))].map(i=>({label:String(i),value:i}))}applyFilters(){this.filteredData=this.combinedData.filter(e=>this.matchesFilter(e,"year_date",this.activeFilters.year)&&this.matchesFilter(e,"car_model_id",this.activeFilters.model)&&this.matchesFilter(e,"car_brand_id",this.activeFilters.brand)&&this.matchesFilter(e,"car_type_id",this.activeFilters.type)&&this.matchesFilter(e,"active_status",this.activeFilters.status)&&this.matchesSearch(e)),this.totalRecords=this.filteredData.length,this.first=0,this.currentPage=1}matchesFilter(e,n,t){return t?e[n]?.toString()===t.toString():!0}matchesSearch(e){return this.searchTerm?[e.id.toString(),e.year_date,e.car_model_title,e.car_brand_title,e.car_type_title,this.normalizeActiveStatus.normalizeActiveStatus(e.active_status)?"active":"inactive"].some(t=>t.toLowerCase().includes(this.searchTerm.toLowerCase())):!0}onGlobalFilter(e){this.searchTerm=e.target.value,this.applyFilters()}onFilterChange(e,n){this.activeFilters[e]=n,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1,this.rowsPerPage=e.rows,this.first=e.first,console.log("Page changed to:",this.currentPage),console.log("Current page info:",this.getCurrentPageInfo())}getCurrentPageInfo(){let e=this.first+1,n=Math.min(this.first+this.rowsPerPage,this.totalRecords);return`${e}-${n} of ${this.totalRecords}`}getPagination(){return[5,10,25,50,100]}goToFirstPage(){this.first=0,this.currentPage=1}goToLastPage(){let e=Math.ceil(this.totalRecords/this.rowsPerPage);this.first=(e-1)*this.rowsPerPage,this.currentPage=e}toggleStatus(e){this.spinner.show("actionsLoader");let n=!this.normalizeActiveStatus.normalizeActiveStatus(e.active_status);(n?this.carYearsService.enable(e.id):this.carYearsService.disable(e.id)).subscribe({next:()=>{e.active_status=String(n),this.applyFilters(),this.showSuccess(`Car year ${n?"enabled":"disabled"} successfully`),this.spinner.hide("actionsLoader")},error:()=>{this.showError("Failed to update car year status"),this.spinner.hide("actionsLoader")}})}showSuccess(e){this.messageService.add({severity:"success",summary:"Success",detail:e})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}onSort(e){this.filteredData.sort((n,t)=>{let i=n[e.field],y=t[e.field];return e.field==="active_status"&&(i=this.normalizeActiveStatus.normalizeActiveStatus(i)?"true":"false",y=this.normalizeActiveStatus.normalizeActiveStatus(y)?"true":"false"),i==null?1:y==null?-1:(i<y?-1:1)*(e.order===1?1:-1)})}static{this.\u0275fac=function(n){return new(n||a)}}static{this.\u0275cmp=M({type:a,selectors:[["app-all-car-years"]],standalone:!0,features:[F([S]),T],decls:3,vars:1,consts:[["search",""],["dt",""],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center","mb-3","gap-2"],[1,"text-xl","md:text-2xl","font-semibold","m-0"],["routerLink","/dashboard/menu/car-years/add","label","Add Car Year","icon","pi pi-plus",1,"btn-main","text-white","w-full","md:w-auto"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right","w-full","md:w-auto"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search car years...",1,"mb-0","w-full",3,"input"],[1,"overflow-x-auto"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","responsiveLayout","scroll","styleClass","p-datatable-sm p-datatable-striped p-datatable-gridlines","scrollDirection","both",3,"onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","scrollable"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id",1,"text-center",2,"min-width","80px"],["field","id"],[1,"text-center",2,"min-width","120px"],["optionLabel","label","optionValue","value","placeholder","Year","appendTo","body",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex","dropdownIcon"],[1,"text-center",2,"min-width","150px"],["optionLabel","label","optionValue","value","placeholder","Model","appendTo","body",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex","dropdownIcon"],["optionLabel","label","optionValue","value","placeholder","Brand","appendTo","body",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex","dropdownIcon"],["optionLabel","label","optionValue","value","placeholder","Type","appendTo","body",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex","dropdownIcon"],["optionLabel","label","optionValue","value","placeholder","Status","appendTo","body",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex","dropdownIcon"],[1,"text-center",2,"min-width","100px"],[1,"text-center"],[3,"onChange","ngModel"],["icon","pi pi-pencil",1,"p-button-text","p-button-sm",3,"routerLink"],["colspan","7"]],template:function(n,t){n&1&&(h(0,"p-toast"),b(1,re,16,7,"div",2)(2,ae,1,0)),n&2&&(l(),P(1,t.combinedData.length>0?1:2))},dependencies:[V,k,Z,L,J,H,z,B,W,j,N,X,K,Q,U,G,q,Y,$,ee],styles:[".overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}@media screen and (max-width: 768px){.p-datatable[_ngcontent-%COMP%]{font-size:.9rem}.p-datatable[_ngcontent-%COMP%]   .p-dropdown[_ngcontent-%COMP%]{width:100%}.p-datatable[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .p-datatable[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem}.p-inputtext[_ngcontent-%COMP%]{width:100%}}"]})}}return a})();export{Ie as AllCarYearsComponent};
