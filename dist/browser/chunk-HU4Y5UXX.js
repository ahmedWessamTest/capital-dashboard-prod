import{a as N}from"./chunk-4IMXXL2Z.js";import{a as B}from"./chunk-DCM55A5P.js";import{a as K,b as Q,c as X,d as Y}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as te}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as H,e as J}from"./chunk-WDDFHKIH.js";import{a as q,b as G}from"./chunk-NZNLV7ZF.js";import"./chunk-AGVKSH7H.js";import{e as k,j as z,p as j}from"./chunk-V2NMUT4R.js";import{a as ee}from"./chunk-2O7EOZOI.js";import{a as I}from"./chunk-KEBJO4LJ.js";import{d as Z,e as U}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{e as W,f as $}from"./chunk-PXM2JOVS.js";import{C as R,x as S}from"./chunk-27E65EIB.js";import{e as D}from"./chunk-67M3DXMG.js";import{n as P}from"./chunk-FYJ5Y7AH.js";import{$a as b,Ab as p,Kb as l,Lb as v,Ob as T,Pb as L,Qa as a,Qb as A,Rb as M,Sb as O,Ub as V,Y as _,ba as E,fb as y,hb as h,ka as c,la as d,mb as F,qb as r,rb as s,sb as m,wb as f,zb as g}from"./chunk-PSXZOWGB.js";import{a as x,b as w}from"./chunk-PSFXZ2QL.js";var ie=o=>["/dashboard/menu/view-employee",o];function ne(o,u){o&1&&m(0,"app-loading-data-banner")}function oe(o,u){if(o&1){let e=f();r(0,"tr")(1,"th",14),l(2," ID "),m(3,"p-sortIcon",15),s(),r(4,"th",16),l(5," Name "),s(),r(6,"th",17),l(7," Email "),s(),r(8,"th",18)(9,"p-dropdown",19),A("ngModelChange",function(i){c(e);let n=p(2);return L(n.activeFilters.is_active,i)||(n.activeFilters.is_active=i),d(i)}),g("onChange",function(i){c(e);let n=p(2);return d(n.onFilterChange("is_active",i.value))}),s()(),r(10,"th",18),l(11,"Actions"),s()()}if(o&2){let e=p(2);a(9),h("options",e.statusOptions),T("ngModel",e.activeFilters.is_active),h("showClear",!0)("autoZIndex",!0)}}function re(o,u){if(o&1){let e=f();r(0,"tr")(1,"td",18),l(2),s(),r(3,"td",18),l(4),s(),r(5,"td",18),l(6),s(),r(7,"td",18)(8,"p-inputSwitch",20),g("onChange",function(){let i=c(e).$implicit,n=p(2);return d(n.toggleStatus(i))}),s()(),r(9,"td",18)(10,"a",21),m(11,"p-button",22),s()()()}if(o&2){let e=u.$implicit;a(2),v(e.id),a(2),v(e.name),a(2),v(e.email),a(2),h("ngModel",e.is_active),a(2),h("routerLink",V(5,ie,e.id))}}function se(o,u){o&1&&(r(0,"tr")(1,"td",23),m(2,"app-no-data-found-banner"),s()())}function ae(o,u){if(o&1){let e=f();r(0,"div",2)(1,"div",3)(2,"h2",4),l(3,"Employees Control"),s(),m(4,"p-button",5),s(),r(5,"div",6)(6,"span",7),m(7,"i",8),r(8,"input",9,0),g("input",function(i){c(e);let n=p();return d(n.onGlobalFilter(i))}),s()()(),r(10,"p-table",10,1),g("onSort",function(i){c(e);let n=p();return d(n.onSort(i))}),y(12,oe,12,4,"ng-template",11)(13,re,12,7,"ng-template",12)(14,se,3,0,"ng-template",13),s()()}if(o&2){let e=p();a(10),h("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredEmployees)}}var Ve=(()=>{class o{constructor(){this.employees=[],this.filteredEmployees=[],this.nameOptions=[],this.emailOptions=[],this.roleOptions=[],this.isLoading=b(!1),this.statusOptions=[{label:"Active",value:1},{label:"Deleted",value:0}],this.activeFilters={name:null,email:null,role:null,is_active:null},this.totalRecords=0,this.rowsPerPage=10,this.searchTerm="",this.userService=_(N),this.spinner=_(I),this.messageService=_(S),this.normalizeActiveStatusService=_(B)}ngOnInit(){this.spinner.show("actionsLoader"),this.isLoading.set(!0),this.userService.getAllEmployees().subscribe({next:e=>{this.employees=e.data.map(t=>w(x({},t),{is_active:!this.normalizeActiveStatusService.normalizeActiveStatus(t.delete_status)})),this.filteredEmployees=[...this.employees],this.totalRecords=this.employees.length,this.initFilterOptions(),this.spinner.hide("actionsLoader"),this.isLoading.set(!1)},error:()=>{this.showError("Failed to load employees"),this.spinner.hide("actionsLoader"),this.isLoading.set(!1)}})}initFilterOptions(){this.nameOptions=this.getDistinctOptions(this.employees,"name"),this.emailOptions=this.getDistinctOptions(this.employees,"email"),this.roleOptions=this.getDistinctOptions(this.employees,"role")}getDistinctOptions(e,t){return[...new Set(e.map(n=>n[t]))].filter(n=>n).map(n=>({label:String(n),value:n}))}applyFilters(){this.filteredEmployees=this.employees.filter(e=>this.matchesFilter(e,"name",this.activeFilters.name)&&this.matchesFilter(e,"email",this.activeFilters.email)&&this.matchesFilter(e,"role",this.activeFilters.role)&&this.matchesFilter(e,"is_active",this.activeFilters.is_active)&&this.matchesSearch(e)),this.totalRecords=this.filteredEmployees.length}matchesFilter(e,t,i){return!i&&i!==0?!0:t==="is_active"?e.is_active===(i===1):e[t]?.toString()===i.toString()}matchesSearch(e){return this.searchTerm?[e.id.toString(),e.name,e.email||"",e.role,e.is_active?"active":"deleted"].some(i=>i.toLowerCase().includes(this.searchTerm.toLowerCase())):!0}onGlobalFilter(e){this.searchTerm=e.target.value,this.applyFilters()}onFilterChange(e,t){this.activeFilters[e]=t,this.applyFilters()}toggleStatus(e){this.spinner.show("actionsLoader");let t=e.is_active?1:0;(t?this.userService.delete(e.id):this.userService.activate(e.id)).subscribe({next:()=>{e.is_active=t?0:1,this.applyFilters(),this.showSuccess(`Employee ${e.is_active?"activated":"deleted"} successfully`),this.spinner.hide("actionsLoader")},error:()=>{this.showError("Failed to update employee status"),this.spinner.hide("actionsLoader")}})}showSuccess(e){this.messageService.add({severity:"success",summary:"Success",detail:e})}showError(e){this.messageService.add({severity:"error",summary:"Error",detail:e})}getPagination(){let e=this.filteredEmployees.length;return[10,25,50,100,e].filter(t=>t<=e)}onSort(e){this.filteredEmployees.sort((t,i)=>{let n=t[e.field],C=i[e.field];return n==null?1:C==null?-1:(n<C?-1:1)*(e.order===1?1:-1)})}static{this.\u0275fac=function(t){return new(t||o)}}static{this.\u0275cmp=E({type:o,selectors:[["app-all-employees"]],standalone:!0,features:[M([S]),O],decls:3,vars:1,consts:[["search",""],["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],["routerLink","/dashboard/menu/add-employee","label","Add Employee","icon","pi pi-plus",1,"btn-main","text-white"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search Employees...",1,"mb-0",3,"input"],["responsiveLayout","scroll",3,"onSort","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["pSortableColumn","email",1,"text-center"],[1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Status",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],[3,"onChange","ngModel"],[3,"routerLink"],["icon","pi pi-eye",1,"p-button-text"],["colspan","6"]],template:function(t,i){t&1&&(m(0,"p-toast"),y(1,ne,1,0,"app-loading-data-banner")(2,ae,15,6)),t&2&&(a(),F(1,i.isLoading()?1:2))},dependencies:[P,$,W,R,J,H,j,k,z,G,q,Y,K,Q,X,U,Z,D,ee,te]})}}return o})();export{Ve as AllEmployeesComponent};
