import{a as H}from"./chunk-GTYEJOMG.js";import{a as ae,b as oe,c as re,d as se}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as de}from"./chunk-Y6SZKX5H.js";import{b as ie}from"./chunk-4WY6IZPL.js";import{d as ne,e as le}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{e as J,j as K,p as X}from"./chunk-V2NMUT4R.js";import{a as pe}from"./chunk-2O7EOZOI.js";import{a as G,c as U}from"./chunk-KEBJO4LJ.js";import{d as ee,e as te}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as Y}from"./chunk-PXM2JOVS.js";import{C as z,x as w}from"./chunk-27E65EIB.js";import{b as Q,e as W}from"./chunk-67M3DXMG.js";import{h as q,n as B}from"./chunk-FYJ5Y7AH.js";import{$a as E,Ab as g,Gb as P,Hb as L,Ib as V,Jb as D,Kb as d,Lb as _,Ob as O,Pb as R,Qa as o,Qb as N,Ra as F,Rb as $,Sb as j,Tb as k,Ub as v,Y as S,ba as M,fb as f,hb as c,ka as C,kb as I,la as h,mb as A,mc as Z,qb as a,rb as r,sb as u,wb as y,zb as x}from"./chunk-PSXZOWGB.js";import{a as b,b as T}from"./chunk-PSFXZ2QL.js";var ce=["dt"],ue=t=>["/dashboard/menu/medical-claims/comments",t],_e=()=>({width:"100%"}),ge=t=>["/dashboard/menu/medical-claims/view-medical-claim",t];function Ce(t,m){t&1&&u(0,"app-loading-data-banner")}function he(t,m){if(t&1&&(a(0,"div",30),u(1,"i",31),a(2,"span",32),d(3),r()()),t&2){let e=m.$implicit;o(),c("ngClass",e.icon+" "+e.color),o(),c("ngClass",e.color),o(),_(e.label)}}function fe(t,m){if(t&1&&(a(0,"div",30),u(1,"i",31),a(2,"span",32),d(3),r()()),t&2){let e=m.$implicit;o(),c("ngClass",e.icon+" "+e.color),o(),c("ngClass",e.color),o(),_(e.label)}}function xe(t,m){if(t&1&&(a(0,"span"),d(1),r()),t&2){let e=m.$implicit;o(),_(e.label)}}function Se(t,m){if(t&1&&(a(0,"span"),d(1),r()),t&2){let e=m.$implicit;o(),_(e.label)}}function ye(t,m){if(t&1){let e=y();a(0,"tr",13)(1,"th",14),d(2,"ID "),u(3,"p-sortIcon",15),r(),a(4,"th",16),d(5,"Name "),u(6,"p-sortIcon",17),r(),a(7,"th",18),d(8,"Email "),u(9,"p-sortIcon",19),r(),a(10,"th",20),d(11,"Phone "),u(12,"p-sortIcon",21),r(),a(13,"th",22),d(14,"Created "),u(15,"p-sortIcon",23),r(),a(16,"th",13),d(17,"Comments"),r(),a(18,"th",24)(19,"p-dropdown",25),x("onChange",function(n){C(e);let l=g(2);return h(l.onFilterChange(n.value))}),f(20,he,4,3,"ng-template",26)(21,fe,4,3,"ng-template",27),r()(),a(22,"th",28)(23,"p-dropdown",29),x("onChange",function(n){C(e);let l=g(2);return h(l.onTypeFilterChange(n.value))}),f(24,xe,2,1,"ng-template",26)(25,Se,2,1,"ng-template",27),r()(),a(26,"th",13),d(27,"Actions"),r()()}if(t&2){let e=g(2);o(19),c("options",e.selectOptions)("showClear",!0)("autoZIndex",!0),o(4),c("options",e.typeOptions)("showClear",!0)("autoZIndex",!0)}}function ve(t,m){if(t&1&&(a(0,"div",30),u(1,"i",31),a(2,"span",32),d(3),r()()),t&2){let e=m.$implicit;o(),c("ngClass",e.icon+" "+e.color),o(),c("ngClass",e.color),o(),_(e.label)}}function we(t,m){if(t&1&&(a(0,"div",30),u(1,"i",31),a(2,"span",32),d(3),r()()),t&2){let e=m.$implicit;o(),c("ngClass",e.icon+" "+e.color),o(),c("ngClass",e.color),o(),_(e.label)}}function be(t,m){if(t&1){let e=y();a(0,"tr",13)(1,"td"),d(2),r(),a(3,"td"),d(4),r(),a(5,"td"),d(6),r(),a(7,"td"),d(8),r(),a(9,"td"),d(10),r(),a(11,"td")(12,"a",33),u(13,"i",34),r()(),a(14,"td",32)(15,"p-dropdown",35),N("ngModelChange",function(n){let l=C(e).$implicit;return R(l.status,n)||(l.status=n),h(n)}),x("onChange",function(n){let l=C(e).$implicit,p=g(2);return h(p.updateClaimStatus(l,n.value))}),f(16,ve,4,3,"ng-template",26)(17,we,4,3,"ng-template",27),r()(),a(18,"td"),d(19),r(),a(20,"td")(21,"div",36)(22,"a",33),u(23,"i",37),r()()()()}if(t&2){let e=m.$implicit,i=g(2);o(2),_(e.id),o(2),_(e.name),o(2),_(e.email),o(2),_(e.phone),o(2),_(i.formatDate(e.created_at)),o(2),c("routerLink",v(15,ue,e.id)),o(2),c("ngClass",i.getStatusClass(e.status)),o(),I(k(17,_e)),c("options",i.getAvailableStatusOptions(e.status)),O("ngModel",e.status),c("autoZIndex",!0)("appendTo","body"),o(4),_(i.getClaimType(e)),o(3),c("routerLink",v(18,ge,e.id))}}function Te(t,m){t&1&&(a(0,"tr",13)(1,"td",38),u(2,"app-no-data-found-banner"),r()())}function Me(t,m){if(t&1){let e=y();a(0,"div",1)(1,"div",2)(2,"h2",3),d(3,"Medical Reimbursement"),r()(),a(4,"div",4)(5,"span",5),u(6,"i",6),a(7,"input",7),x("input",function(n){C(e);let l=D(10),p=g();return h(p.onGlobalFilter(l,n))}),r()()(),a(8,"div",8)(9,"p-table",9,0),x("onSort",function(n){C(e);let l=g();return h(l.onSort(n))})("onPage",function(n){C(e);let l=g();return h(l.onPageChange(n))}),f(11,ye,28,6,"ng-template",10)(12,be,24,20,"ng-template",11)(13,Te,3,0,"ng-template",12),r()()()}if(t&2){let e=g();o(9),c("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredClaims)("scrollable",!0)("sortMode","multiple")}}var Je=(()=>{class t{ngOnInit(){this.initDropDownFilter(),this.initTypeFilter(),this.isLoading.set(!0),this.claims=this.route.snapshot.data.data?.data||[],this.isLoading.set(!1),console.log("Claims:",this.claims),this.applyFilters(),this.ngxSpinnerService.hide("actionsLoader")}ngAfterViewInit(){console.log("Table reference:",this.dt)}constructor(e){this.cdRef=e,this.ngxSpinnerService=S(G),this.messageService=S(w),this.medicalClaimsService=S(H),this.route=S(Q),this.claims=[],this.isLoading=E(!1),this.filteredClaims=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectedType=null,this.statusSteps=["requested","pending","confirmed","canceled"],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.selectOptions=[],this.typeOptions=[]}initDropDownFilter(){this.selectOptions=[{label:"Requested",value:"requested",icon:"pi pi-inbox",color:"text-blue-600"},{label:"Pending",value:"pending",icon:"pi pi-clock",color:"text-yellow-600"},{label:"Confirmed",value:"confirmed",icon:"pi pi-check-circle",color:"text-green-600"},{label:"Canceled",value:"canceled",icon:"pi pi-times-circle",color:"text-red-600"}],console.log("Status options:",this.selectOptions)}initTypeFilter(){this.typeOptions=[{label:"Manual",value:"manual"},{label:"Ordinary",value:"ordinary"}],console.log("Type options:",this.typeOptions)}getStatusClass(e){switch(e){case"confirmed":return"bg-green-200 text-green-800";case"canceled":return"bg-red-200 text-red-800";case"pending":return"bg-yellow-200 text-yellow-800";case"requested":return"bg-blue-200 text-blue-800";default:return""}}getClaimType(e){return e.medical_insurance_id?"Ordinary":"Manual"}getAvailableStatusOptions(e){let i=this.statusSteps.indexOf(e);return this.selectOptions.filter(n=>!(e==="confirmed"&&n.value==="canceled")).map((n,l)=>T(b({},n),{disabled:l<i}))}applyFilters(){let e=[...this.claims];this.selectedStatus!==null&&(e=e.filter(i=>i.status===this.selectedStatus)),this.selectedType!==null&&(e=e.filter(i=>this.selectedType==="manual"?i.medical_insurance_id===null:i.medical_insurance_id!==null)),this.sortField&&e.sort((i,n)=>this.compareValues(i,n,this.sortField,this.sortOrder)),this.filteredClaims=e,this.totalRecords=e.length,console.log("Filtered claims:",this.filteredClaims)}onGlobalFilter(e,i){let l=i.target.value.toLowerCase(),p=[...this.claims];p=p.filter(s=>s.medical_insurance_id!==null),this.selectedStatus!==null&&(p=p.filter(s=>s.status===this.selectedStatus)),this.selectedType!==null&&(p=p.filter(s=>this.selectedType==="manual"?s.medical_insurance_id===null:s.medical_insurance_id!==null)),l&&(p=p.filter(s=>s.id.toString().includes(l)||s.name.toLowerCase().includes(l)||s.email&&s.email.toLowerCase().includes(l)||s.phone&&s.phone.includes(l)||s.status.toLowerCase().includes(l)||this.getClaimType(s).toLowerCase().includes(l))),this.sortField&&p.sort((s,me)=>this.compareValues(s,me,this.sortField,this.sortOrder)),this.filteredClaims=p,this.totalRecords=p.length,console.log("After global filter:",this.filteredClaims)}compareValues(e,i,n,l){if(!n)return 0;let p=e[n],s=i[n];return n==="id"?(p=Number(p),s=Number(s)):n==="created_at"||n==="updated_at"?(p=new Date(p),s=new Date(s)):n==="type"&&(p=this.getClaimType(e),s=this.getClaimType(i)),p==null?l*-1:s==null?l*1:p<s?l*-1:p>s?l*1:0}onFilterChange(e){console.log("Status filter changed:",e),this.selectedStatus=e,this.applyFilters()}onTypeFilterChange(e){console.log("Type filter changed:",e),this.selectedType=e,this.applyFilters()}onSort(e){console.log("Sort event:",e),this.sortField=e.field,this.sortOrder=e.order,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1,console.log("Page changed:",this.currentPage)}updateClaimStatus(e,i){this.ngxSpinnerService.show("actionsLoader");let n=new FormData;n.append("status",i),this.medicalClaimsService.update(e.id,n).subscribe({next:l=>{e.status=l.data.status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:l.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update claim status"}),this.ngxSpinnerService.hide("actionsLoader")}})}getPagination(){let e=this.filteredClaims.length;return[10,25,50,100,e].filter(i=>i<=e)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}static{this.\u0275fac=function(i){return new(i||t)(F(Z))}}static{this.\u0275cmp=M({type:t,selectors:[["app-all-medical-claims"]],viewQuery:function(i,n){if(i&1&&P(ce,5),i&2){let l;L(l=V())&&(n.dt=l.first)}},standalone:!0,features:[$([w]),j],decls:3,vars:1,consts:[["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-content-end","gap-3"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search claims...",3,"input"],[1,"overflow-x-auto"],["responsiveLayout","scroll","scrollDirection","both","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","scrollable","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","email",1,"text-center"],["field","email"],["pSortableColumn","phone",1,"text-center"],["field","phone"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],["pSortableColumn","status",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Status",3,"onChange","options","showClear","autoZIndex"],["pTemplate","selectedItem"],["pTemplate","item"],["pSortableColumn","type",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Type",3,"onChange","options","showClear","autoZIndex"],[1,"flex","items-center","justify-center"],[1,"mr-2",3,"ngClass"],[3,"ngClass"],[3,"routerLink"],[1,"pi","pi-comments"],["optionLabel","label","optionValue","value","styleClass","status-dropdown",3,"ngModelChange","onChange","options","ngModel","autoZIndex","appendTo"],[1,"flex","gap-2","items-center","justify-center"],[1,"pi","pi-eye"],["colspan","9"]],template:function(i,n){i&1&&(u(0,"p-toast"),f(1,Ce,1,0,"app-loading-data-banner")(2,Me,14,8)),i&2&&(o(),A(1,n.isLoading()?1:2))},dependencies:[Y,z,le,ne,se,ae,oe,re,te,ee,W,pe,de,B,q,X,J,K,U,ie]})}}return t})();export{Je as AllMedicalClaimsComponent};
