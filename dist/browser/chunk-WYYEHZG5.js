import{a as B}from"./chunk-ZJLCIVCJ.js";import{a as O}from"./chunk-DCM55A5P.js";import{a as K,b as Q,c as U,d as X}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as tt}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as H,e as J}from"./chunk-WDDFHKIH.js";import{a as j,b as G}from"./chunk-NZNLV7ZF.js";import"./chunk-AGVKSH7H.js";import{e as R,j as W,p as N}from"./chunk-V2NMUT4R.js";import{a as Y}from"./chunk-2O7EOZOI.js";import{a as P}from"./chunk-KEBJO4LJ.js";import{d as $,e as q}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{e as k,f as Z}from"./chunk-PXM2JOVS.js";import{C as z,x as M}from"./chunk-27E65EIB.js";import{b as V,e as I}from"./chunk-67M3DXMG.js";import{n as D}from"./chunk-FYJ5Y7AH.js";import{$a as F,Ab as s,Kb as p,Lb as g,Ob as x,Pb as b,Qa as l,Qb as w,Rb as T,Sb as E,Ub as L,Y as h,ba as y,fb as v,hb as u,ka as c,la as m,mb as A,qb as r,rb as a,sb as d,wb as S,zb as _}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var et=o=>["/dashboard/menu/car-models/edit",o];function it(o,C){o&1&&d(0,"app-loading-data-banner")}function nt(o,C){if(o&1){let t=S();r(0,"tr")(1,"th",14),p(2," ID "),d(3,"p-sortIcon",15),a(),r(4,"th",16),p(5," English Title "),d(6,"p-sortIcon",17),a(),r(7,"th",18),p(8," Arabic Title "),d(9,"p-sortIcon",19),a(),r(10,"th",20)(11,"p-dropdown",21),w("ngModelChange",function(e){c(t);let n=s(2);return b(n.activeFilters.brand,e)||(n.activeFilters.brand=e),m(e)}),_("onChange",function(e){c(t);let n=s(2);return m(n.onFilterChange("brand",e.value))}),a()(),r(12,"th",20)(13,"p-dropdown",22),w("ngModelChange",function(e){c(t);let n=s(2);return b(n.activeFilters.status,e)||(n.activeFilters.status=e),m(e)}),_("onChange",function(e){c(t);let n=s(2);return m(n.onFilterChange("status",e.value))}),a()(),r(14,"th",20),p(15,"Actions"),a()()}if(o&2){let t=s(2);l(11),u("options",t.brandOptions),x("ngModel",t.activeFilters.brand),u("showClear",!0)("autoZIndex",!0),l(2),u("options",t.statusOptions),x("ngModel",t.activeFilters.status),u("showClear",!0)("autoZIndex",!0)}}function ot(o,C){if(o&1){let t=S();r(0,"tr")(1,"td",20),p(2),a(),r(3,"td",20),p(4),a(),r(5,"td",20),p(6),a(),r(7,"td",20),p(8),a(),r(9,"td",20)(10,"p-inputSwitch",23),_("onChange",function(){let e=c(t).$implicit,n=s(2);return m(n.toggleStatus(e))}),a()(),r(11,"td",20),d(12,"p-button",24),a()()}if(o&2){let t=C.$implicit,i=s(2);l(2),g(t.id),l(2),g(t.en_title),l(2),g(t.ar_title),l(2),g(t.car_brand_title),l(2),u("ngModel",i.normalizeActiveStatus.normalizeActiveStatus(t.active_status)),l(2),u("routerLink",L(6,et,t.id))}}function rt(o,C){o&1&&(r(0,"tr")(1,"td",25),d(2,"app-no-data-found-banner"),a()())}function at(o,C){if(o&1){let t=S();r(0,"div",2)(1,"div",3)(2,"h2",4),p(3,"Car Models Control"),a(),d(4,"p-button",5),a(),r(5,"div",6)(6,"span",7),d(7,"i",8),r(8,"input",9,0),_("input",function(e){c(t);let n=s();return m(n.onGlobalFilter(e))}),a()()(),r(10,"p-table",10,1),_("onSort",function(e){c(t);let n=s();return m(n.onSort(e))}),v(12,nt,16,8,"ng-template",11)(13,ot,13,8,"ng-template",12)(14,rt,3,0,"ng-template",13),a()()}if(o&2){let t=s();l(10),u("paginator",!0)("rows",t.rowsPerPage)("totalRecords",t.totalRecords)("rowsPerPageOptions",t.getPagination())("showCurrentPageReport",!0)("value",t.filteredData)}}var Dt=(()=>{class o{constructor(){this.combinedData=[],this.filteredData=[],this.carBrands=[],this.carTypes=[],this.isLoading=F(!1),this.brandOptions=[],this.typeOptions=[],this.statusOptions=[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],this.activeFilters={brand:null,type:null,status:null},this.totalRecords=0,this.rowsPerPage=10,this.currentPage=1,this.searchTerm="",this.carModelsService=h(B),this.normalizeActiveStatus=h(O),this.spinner=h(P),this.messageService=h(M),this.route=h(V)}ngOnInit(){this.isLoading.set(!0),this.spinner.show(),this.route.data.subscribe({next:({data:t})=>{this.isLoading.set(!1),this.combinedData=t.combinedData,this.carBrands=t.carBrands,this.carTypes=t.carTypes,this.filteredData=[...this.combinedData],this.totalRecords=this.combinedData.length,this.initFilterOptions(),this.spinner.hide()},error:()=>{this.showError("Failed to load data"),this.spinner.hide(),this.isLoading.set(!1)}})}initFilterOptions(){this.brandOptions=this.carBrands.map(t=>({label:t.en_title,value:t.id})),this.typeOptions=this.carTypes.map(t=>({label:t.en_title,value:t.id}))}applyFilters(){this.filteredData=this.combinedData.filter(t=>this.matchesFilter(t,"car_brand_id",this.activeFilters.brand)&&this.matchesFilter(t,"active_status",this.activeFilters.status)&&this.matchesSearch(t)),this.totalRecords=this.filteredData.length}matchesFilter(t,i,e){return e?t[i]?.toString()===e.toString():!0}matchesSearch(t){return this.searchTerm?[t.id.toString(),t.en_title,t.ar_title,t.car_brand_title,this.normalizeActiveStatus.normalizeActiveStatus(t.active_status)?"active":"inactive"].some(e=>e.toLowerCase().includes(this.searchTerm.toLowerCase())):!0}onGlobalFilter(t){this.searchTerm=t.target.value,this.applyFilters()}onFilterChange(t,i){this.activeFilters[t]=i,this.applyFilters()}toggleStatus(t){this.spinner.show("actionsLoader");let i=!this.normalizeActiveStatus.normalizeActiveStatus(t.active_status);(i?this.carModelsService.enable(t.id):this.carModelsService.disable(t.id)).subscribe({next:()=>{t.active_status=String(i),this.applyFilters(),this.showSuccess(`Car model ${i?"enabled":"disabled"} successfully`),this.spinner.hide("actionsLoader")},error:()=>{this.showError("Failed to update car model status"),this.spinner.hide("actionsLoader")}})}showSuccess(t){this.messageService.add({severity:"success",summary:"Success",detail:t})}showError(t){this.messageService.add({severity:"error",summary:"Error",detail:t})}getPagination(){return[10,25,50,100]}onSort(t){this.filteredData.sort((i,e)=>{let n=i[t.field],f=e[t.field];return t.field==="active_status"&&(n=this.normalizeActiveStatus.normalizeActiveStatus(n)?"true":"false",f=this.normalizeActiveStatus.normalizeActiveStatus(f)?"true":"false"),n==null?1:f==null?-1:(n<f?-1:1)*(t.order===1?1:-1)})}static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275cmp=y({type:o,selectors:[["app-all-car-models"]],standalone:!0,features:[T([M]),E],decls:3,vars:1,consts:[["search",""],["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],["routerLink","/dashboard/menu/car-models/add","label","Add Car Model","icon","pi pi-plus",1,"btn-main","text-white"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search car models...",1,"mb-0",3,"input"],["responsiveLayout","scroll",3,"onSort","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","en_title",1,"text-center"],["field","en_title"],["pSortableColumn","ar_title",1,"text-center"],["field","ar_title"],[1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Brand",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],["optionLabel","label","optionValue","value","placeholder","Status",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],[3,"onChange","ngModel"],["icon","pi pi-pencil",1,"p-button-text",3,"routerLink"],["colspan","7"]],template:function(i,e){i&1&&(d(0,"p-toast"),v(1,it,1,0,"app-loading-data-banner")(2,at,15,6)),i&2&&(l(),A(1,e.isLoading()?1:2))},dependencies:[D,Z,k,z,J,H,N,R,W,G,j,X,K,Q,U,q,$,I,Y,tt]})}}return o})();export{Dt as AllCarModelComponent};
