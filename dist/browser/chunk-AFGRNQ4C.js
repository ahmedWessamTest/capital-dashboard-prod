import{a as U}from"./chunk-PULJ7UNU.js";import{a as ie,b as ne,c as ae,d as oe}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as re}from"./chunk-Y6SZKX5H.js";import{b as Y}from"./chunk-4WY6IZPL.js";import{d as ee,e as te}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{p as J}from"./chunk-V2NMUT4R.js";import{a as le}from"./chunk-2O7EOZOI.js";import{a as G,c as z}from"./chunk-KEBJO4LJ.js";import{d as W,e as X}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as K}from"./chunk-PXM2JOVS.js";import{C as H,x as w}from"./chunk-27E65EIB.js";import{b as Q,e as Z}from"./chunk-67M3DXMG.js";import{h as j,j as $,n as B}from"./chunk-FYJ5Y7AH.js";import{$a as I,Ab as m,Gb as L,Hb as P,Ib as O,Jb as b,Kb as d,Lb as h,Mb as A,Qa as s,Ra as F,Rb as D,Sb as V,Tb as k,Ub as y,Y as C,ba as M,fb as v,hb as _,ka as g,la as x,lb as f,mb as E,mc as N,qb as a,rb as l,sb as p,wb as q,zb as S}from"./chunk-PSXZOWGB.js";import{a as R,b as T}from"./chunk-PSFXZ2QL.js";var ce=["dt"],de=()=>({"min-width":"70rem"}),pe=i=>["/dashboard/menu/medical-request/comments",i],ue=i=>["/dashboard/menu/medical-requests/edit",i],me=i=>["/dashboard/menu/medical-requests/view-medical-request",i];function _e(i,u){i&1&&p(0,"app-loading-data-banner")}function he(i,u){if(i&1&&(a(0,"div",29),p(1,"i",30),a(2,"span"),d(3),l()()),i&2){let e=u.$implicit;s(),f(e.icon+" "+e.color),s(),f(e.color),s(),h(e.label)}}function fe(i,u){if(i&1&&(a(0,"div",29),p(1,"i",30),a(2,"span"),d(3),l()()),i&2){let e=u.$implicit;s(),f(e.icon+" "+e.color),s(),f(e.color),s(),h(e.label)}}function ge(i,u){if(i&1){let e=q();a(0,"tr",13)(1,"th",14),d(2," ID "),p(3,"p-sortIcon",15),l(),a(4,"th",16),d(5," Name "),p(6,"p-sortIcon",17),l(),a(7,"th",18),d(8," Email "),p(9,"p-sortIcon",19),l(),a(10,"th",20),d(11," Phone "),p(12,"p-sortIcon",21),l(),a(13,"th",13)(14,"p-dropdown",22,1),S("onChange",function(n){g(e);let o=b(15);return m(2).onRequestTypeFilterChange(n.value),x(o.showClear=!0)}),l()(),a(16,"th",23),d(17," Created "),p(18,"p-sortIcon",24),l(),a(19,"th",13),d(20,"Comments"),l(),a(21,"th",25)(22,"p-dropdown",26),S("onChange",function(n){g(e);let o=m(2);return x(o.onFilterChange(n.value))}),v(23,he,4,5,"ng-template",27)(24,fe,4,5,"ng-template",28),l()(),a(25,"th",13),d(26,"Actions"),l()()}if(i&2){let e=m(2);s(14),_("options",e.requestTypeOptions)("showClear",!0)("autoZIndex",!0),s(8),_("options",e.selectOptions)("showClear",!0)("autoZIndex",!0)}}function xe(i,u){if(i&1&&(a(0,"a",31),p(1,"i",37),l()),i&2){let e=m().$implicit;_("routerLink",y(1,ue,e.id))}}function Ce(i,u){if(i&1&&(a(0,"a",31),p(1,"i",38),l()),i&2){let e=m().$implicit;_("routerLink",y(1,me,e.id))}}function ve(i,u){if(i&1&&(a(0,"tr",13)(1,"td"),d(2),l(),a(3,"td"),d(4),l(),a(5,"td"),d(6),l(),a(7,"td"),d(8),l(),a(9,"td"),d(10),l(),a(11,"td"),d(12),l(),a(13,"td")(14,"a",31),p(15,"i",32),l()(),a(16,"td",33)(17,"div",34),p(18,"i",30),a(19,"span"),d(20),l()()(),a(21,"td")(22,"div",35),v(23,xe,2,3,"a",36)(24,Ce,2,3,"a",36),l()()()),i&2){let e=u.$implicit,t=m(2);s(2),h(e.id),s(2),h(e.name),s(2),h(e.email),s(2),h(e.phone),s(2),h(e.request_type||"individual"),s(2),h(t.formatDate(e.created_at)),s(2),_("routerLink",y(15,pe,e.id)),s(2),_("ngClass",t.getStatusClass(e.active_status)),s(2),f(t.getStatusIcon(e.active_status)+" "+t.getStatusColor(e.active_status)),s(),f(t.getStatusColor(e.active_status)),s(),A(" ",t.getStatusLabel(e.active_status)," "),s(3),_("ngIf",e==null?null:e.id),s(),_("ngIf",e==null?null:e.id)}}function Se(i,u){i&1&&(a(0,"tr",13)(1,"td",39),p(2,"app-no-data-found-banner"),l()())}function ye(i,u){if(i&1){let e=q();a(0,"div",2)(1,"div",3)(2,"h2",4),d(3,"Medical Requests"),l()(),a(4,"div",5)(5,"span",6),p(6,"i",7),a(7,"input",8),S("input",function(n){g(e);let o=b(9),c=m();return x(c.onGlobalFilter(o,n))}),l()()(),a(8,"p-table",9,0),S("onSort",function(n){g(e);let o=m();return x(o.onSort(n))})("onPage",function(n){g(e);let o=m();return x(o.onPageChange(n))}),v(10,ge,27,6,"ng-template",10)(11,ve,25,17,"ng-template",11)(12,Se,3,0,"ng-template",12),l()()}if(i&2){let e=m();s(8),_("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredRequests)("tableStyle",k(8,de))("sortMode","multiple")}}var Ue=(()=>{class i{ngOnInit(){this.initDropDownFilter(),this.isLoading.set(!0),this.requests=this.route.snapshot.data.data.data.reverse(),this.isLoading.set(!1),console.log(this.requests),this.initRequestTypeOptions(),this.applyFilters(),this.ngxSpinnerService.hide("actionsLoader")}constructor(e){this.cdRef=e,this.ngxSpinnerService=C(G),this.messageService=C(w),this.medicalRequestsService=C(U),this.route=C(Q),this.isLoading=I(!1),this.requests=[],this.filteredRequests=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectedRequestType=null,this.requestTypeOptions=[],this.statusSteps=["requested","pending","confirmed","canceled"],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.selectOptions=[]}initDropDownFilter(){this.selectOptions=[{label:"Requested",value:"requested",icon:"pi pi-inbox",color:"text-blue-600"},{label:"Pending",value:"pending",icon:"pi pi-clock",color:"text-yellow-600"},{label:"Confirmed",value:"confirmed",icon:"pi pi-check-circle",color:"text-green-600"},{label:"Canceled",value:"canceled",icon:"pi pi-times-circle",color:"text-red-600"}]}initRequestTypeOptions(){let e=[...new Set(this.requests.map(t=>t.request_type||"individual"))];this.requestTypeOptions=e.map(t=>({label:t.charAt(0).toUpperCase()+t.slice(1),value:t}))}getStatusClass(e){switch(e){case"confirmed":return"bg-green-200 text-green-800";case"canceled":return"bg-red-200 text-red-800";case"pending":return"bg-yellow-200 text-yellow-800";case"requested":return"bg-blue-200 text-blue-800";default:return""}}getAvailableStatusOptions(e){let t=this.statusSteps.indexOf(e);return this.selectOptions.filter(n=>!(e==="confirmed"&&n.value==="canceled")).map((n,o)=>T(R({},n),{disabled:o<t}))}applyFilters(){let e=[...this.requests];this.selectedStatus!==null&&(e=e.filter(t=>t.active_status===this.selectedStatus)),this.selectedRequestType!==null&&(e=e.filter(t=>(t.request_type||"individual")===this.selectedRequestType)),this.sortField&&e.sort((t,n)=>this.compareValues(t,n,this.sortField,this.sortOrder)),this.filteredRequests=e,this.totalRecords=e.length}onGlobalFilter(e,t){let o=t.target.value.toLowerCase(),c=[...this.requests];this.selectedStatus!==null&&(c=c.filter(r=>r.active_status===this.selectedStatus)),this.selectedRequestType!==null&&(c=c.filter(r=>(r.request_type||"individual")===this.selectedRequestType)),o&&(c=c.filter(r=>r.id.toString().includes(o)||r.name.toLowerCase().includes(o)||r.email&&r.email.toLowerCase().includes(o)||r.phone&&r.phone.includes(o)||r.active_status.toLowerCase().includes(o)||r.request_type&&r.request_type.toLowerCase().includes(o))),this.sortField&&c.sort((r,se)=>this.compareValues(r,se,this.sortField,this.sortOrder)),this.filteredRequests=c,this.totalRecords=c.length}compareValues(e,t,n,o){if(!n)return 0;let c=e[n],r=t[n];return n==="id"?(c=Number(c),r=Number(r)):(n==="created_at"||n==="updated_at")&&(c=new Date(c),r=new Date(r)),c==null?o*-1:r==null?o*1:c<r?o*-1:c>r?o*1:0}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}onRequestTypeFilterChange(e){this.selectedRequestType=e,this.applyFilters()}onSort(e){this.sortField=e.field,this.sortOrder=e.order,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1}updateRequestStatus(e,t){this.ngxSpinnerService.show("actionsLoader"),(t==="canceled"?this.medicalRequestsService.cancel(e.id):this.medicalRequestsService.confirm(e.id,t)).subscribe({next:o=>{e.active_status=o.data.active_status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:o.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update request status"}),this.ngxSpinnerService.hide("actionsLoader")}})}getPagination(){let e=this.filteredRequests.length;return[10,25,50,100,e].filter(t=>t<=e)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}getStatusLabel(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.label:e}getStatusIcon(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.icon:""}getStatusColor(e){let t=this.selectOptions.find(n=>n.value===e);return t?t.color:""}static{this.\u0275fac=function(t){return new(t||i)(F(N))}}static{this.\u0275cmp=M({type:i,selectors:[["app-all-medical-requests"]],viewQuery:function(t,n){if(t&1&&L(ce,5),t&2){let o;P(o=O())&&(n.dt=o.first)}},standalone:!0,features:[D([w]),V],decls:3,vars:1,consts:[["dt",""],["requestTypeFilter",""],[1,"card","ng-star-inserted","overflow-x-auto"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-content-end","gap-3"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search requests...",3,"input"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","tableStyle","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","email",1,"text-center"],["field","email"],["pSortableColumn","phone",1,"text-center"],["field","phone"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Request Type",1,"mx-auto","max-w-[120px]",3,"onChange","options","showClear","autoZIndex"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],["pSortableColumn","active_status",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Status",3,"onChange","options","showClear","autoZIndex"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"flex","items-center","justify-center"],[1,"mr-2"],[3,"routerLink"],[1,"pi","pi-comments"],[3,"ngClass"],[1,"flex","items-center","justify-center","border","rounded","px-2","py-3","bg-white"],[1,"flex","gap-2","items-center","justify-center"],[3,"routerLink",4,"ngIf"],[1,"pi","pi-pencil"],[1,"pi","pi-eye"],["colspan","8"]],template:function(t,n){t&1&&(p(0,"p-toast"),v(1,_e,1,0,"app-loading-data-banner")(2,ye,13,9)),t&2&&(s(),E(1,n.isLoading()?1:2))},dependencies:[K,H,te,ee,oe,ie,ne,ae,X,W,Z,le,re,B,j,$,J,z,Y],styles:["td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:center}"]})}}return i})();export{Ue as AllMedicalRequestsComponent};
