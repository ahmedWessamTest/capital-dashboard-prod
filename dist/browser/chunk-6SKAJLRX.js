import{a as me}from"./chunk-LV7JVZMU.js";import{a as ye}from"./chunk-RMJHRBA4.js";import{a as ue,b as Ce,c as xe,d as ge}from"./chunk-2CYVADF6.js";import{a as fe}from"./chunk-Y6SZKX5H.js";import{d as de,e as pe}from"./chunk-WDDFHKIH.js";import{a as re,b as ce}from"./chunk-NZNLV7ZF.js";import{e as ie,j as ne,p as oe}from"./chunk-V2NMUT4R.js";import{a as he}from"./chunk-2O7EOZOI.js";import{a as X,c as ee}from"./chunk-KEBJO4LJ.js";import{d as se,e as _e}from"./chunk-PEYIU4ER.js";import{b as K}from"./chunk-RJZ3H7D5.js";import{e as ae,f as le}from"./chunk-PXM2JOVS.js";import{C as te,x as $}from"./chunk-27E65EIB.js";import{e as J}from"./chunk-67M3DXMG.js";import{n as H}from"./chunk-FYJ5Y7AH.js";import{Ab as o,Eb as I,Gb as B,Hb as W,Ib as j,Jb as U,Kb as h,Lb as Z,Ma as E,Mb as b,Ob as S,Pb as F,Qa as s,Qb as R,Rb as z,Sb as Q,Tb as q,Vb as v,Wb as G,Y as T,ba as k,fb as m,gb as O,hb as _,ja as A,ka as x,la as g,mb as u,mc as Y,ob as M,pb as P,qb as r,rb as c,sb as C,wb as w,zb as y}from"./chunk-PSXZOWGB.js";import{a as D,b as V}from"./chunk-PSFXZ2QL.js";var we=["dt"],be=(t,l)=>l.field,Te=()=>({"min-width":"700px"}),L=(t,l)=>[t,l],N=(t,l,e)=>[t,l,e];function ve(t,l){if(t&1&&(r(0,"a",17),C(1,"p-button",18),c()),t&2){let e=o(3);_("routerLink",v(3,L,e.addRoute,e.addRoute2)),s(),I("label","Add ",e.title,"")}}function Se(t,l){if(t&1&&(r(0,"a",17),C(1,"p-button",18),c()),t&2){let e=o(3);_("routerLink",e.addRoute),s(),I("label","Add ",e.title,"")}}function Fe(t,l){if(t&1&&m(0,ve,2,6,"a",17)(1,Se,2,3),t&2){let e=o(2);u(0,e.addRoute2?0:1)}}function Re(t,l){if(t&1&&(r(0,"th",20),h(1),C(2,"p-sortIcon",21),c()),t&2){let e=o().$implicit;_("pSortableColumn",e.field),s(),b(" ",e.header," "),s(),_("field",e.field)}}function Ge(t,l){if(t&1){let e=w();r(0,"th",19)(1,"p-dropdown",22,2),R("ngModelChange",function(n){x(e);let a=o(4);return F(a.selectedCategory,n)||(a.selectedCategory=n),g(n)}),y("onChange",function(n){x(e);let a=o(4);return g(a.onCategoryFilterChange(n.value))}),c()()}if(t&2){let e=o(4);s(),_("options",e.categoryOptions),S("ngModel",e.selectedCategory),_("showClear",!0)("autoZIndex",!0)}}function Le(t,l){if(t&1){let e=w();r(0,"th",19)(1,"p-dropdown",23,3),R("ngModelChange",function(n){x(e);let a=o(4);return F(a.selectedNeedCall,n)||(a.selectedNeedCall=n),g(n)}),y("onChange",function(n){x(e);let a=o(4);return g(a.onNeedCallFilterChange(n.value))}),c()()}if(t&2){let e=o(4);s(),_("options",e.needCallOptions),S("ngModel",e.selectedNeedCall),_("showClear",!0)("autoZIndex",!0)}}function De(t,l){if(t&1&&(r(0,"th",19),h(1),c()),t&2){let e=o().$implicit;s(),b(" ",e.header," ")}}function Ve(t,l){if(t&1&&m(0,Re,3,3,"th",20)(1,Ge,3,4)(2,Le,3,4)(3,De,2,1),t&2){let e=l.$implicit;u(0,e.sortable?0:e.field==="category_id"||e.field==="build_type_id"?1:e.field==="need_call"?2:3)}}function Ee(t,l){if(t&1){let e=w();r(0,"th",19)(1,"p-dropdown",24,4),R("ngModelChange",function(n){x(e);let a=o(3);return F(a.selectedStatus,n)||(a.selectedStatus=n),g(n)}),y("onChange",function(n){x(e);let a=o(3);return g(a.onFilterChange(n.value))}),c()()}if(t&2){let e=o(3);s(),_("options",e.selectOptions),S("ngModel",e.selectedStatus),_("showClear",!0)("autoZIndex",!0)}}function Me(t,l){if(t&1&&(r(0,"tr",19),M(1,Ve,4,1,null,null,be),m(3,Ee,3,4,"th",19),r(4,"th",19),h(5,"Actions"),c()()),t&2){let e=o(2);s(),P(e.columns),s(2),u(3,e.ToggelStatus?3:-1)}}function Pe(t,l){if(t&1&&(r(0,"div",27),C(1,"img",28),c()),t&2){let e=o().$implicit,i=o().$implicit,n=o(2);s(),_("src",n.getImageUrl(i[e.field]),E)("alt",i.en_title||i.en_name||i.en_blog_title||"image")}}function Ie(t,l){if(t&1&&h(0),t&2){let e=o().$implicit,i=o().$implicit,n=o(2);b(" ",n.formatDate(i[e.field])," ")}}function $e(t,l){if(t&1&&(r(0,"a",29),h(1),c()),t&2){let e=o().$implicit,i=o().$implicit;_("href",i[e.field],E),s(),b(" ","Network_link"," ")}}function Ne(t,l){if(t&1&&(r(0,"a",30),C(1,"p-button",31),c()),t&2){let e=o(3).$implicit,i=o().$implicit,n=o(2);_("routerLink",G(2,N,n.choicesRoute,i.id,n.choicesRoute2))("title",e.displayFn?e.displayFn(i):"")}}function ke(t,l){if(t&1&&(r(0,"a",30),C(1,"p-button",31),c()),t&2){let e=o(3).$implicit,i=o().$implicit,n=o(2);_("routerLink",v(2,L,n.choicesRoute,i.id))("title",e.displayFn?e.displayFn(i):"")}}function Ae(t,l){if(t&1&&m(0,Ne,2,6,"a",30)(1,ke,2,5),t&2){let e=o(5);u(0,e.choicesRoute2?0:1)}}function Oe(t,l){t&1&&(r(0,"span"),h(1,"N/A"),c())}function Be(t,l){if(t&1&&m(0,Ae,2,1)(1,Oe,2,0),t&2){let e=o().$implicit,i=o().$implicit;u(0,e.choicesProperty&&(i[e.choicesProperty]==null?null:i[e.choicesProperty].length)>0?0:1)}}function We(t,l){if(t&1&&(r(0,"span",32),h(1),c()),t&2){let e=o(2).$implicit,i=o().$implicit,n=o(2);_("title",e.displayFn(i)),s(),b(" ",n.truncateText(e.displayFn(i),e.maxLength||30)," ")}}function je(t,l){if(t&1&&(r(0,"span",32),h(1),c()),t&2){let e=o(2).$implicit,i=o().$implicit,n=o(2);_("title",i[e.field]),s(),b(" ",i[e.field]!==null?n.truncateText(i[e.field],e.maxLength||30):"N/A"," ")}}function Ue(t,l){if(t&1&&m(0,We,2,2,"span",32)(1,je,2,2),t&2){let e=o().$implicit;u(0,e.displayFn?0:1)}}function Ze(t,l){if(t&1&&(r(0,"td",19),m(1,Pe,2,2,"div",27)(2,Ie,1,1)(3,$e,2,2)(4,Be,2,1)(5,Ue,2,1),c()),t&2){let e=l.$implicit;s(),u(1,e.type==="image"?1:e.type==="date"?2:e.type==="link"?3:e.field==="choices"?4:5)}}function ze(t,l){if(t&1){let e=w();r(0,"td",19)(1,"p-inputSwitch",33),y("onChange",function(){x(e);let n=o().$implicit,a=o(2);return g(a.toggleStatus(n))}),c()()}if(t&2){let e=o().$implicit;s(),_("ngModel",e.active_status)}}function Qe(t,l){if(t&1&&(r(0,"a",34),C(1,"p-button",35),c()),t&2){let e=o(2).$implicit,i=o(2);_("routerLink",G(1,N,i.editRoute,e.id,i.editRoute2))}}function qe(t,l){if(t&1&&(r(0,"a",34),C(1,"p-button",35),c()),t&2){let e=o(2).$implicit,i=o(2);_("routerLink",v(1,L,i.editRoute,e.id))}}function Ye(t,l){if(t&1&&m(0,Qe,2,5,"a",34)(1,qe,2,4),t&2){let e=o(3);u(0,e.editRoute2?0:1)}}function He(t,l){if(t&1&&(r(0,"a",34),C(1,"p-button",36),c()),t&2){let e=o(2).$implicit,i=o(2);_("routerLink",G(1,N,i.viewRoute,e.id,i.viewRoute2))}}function Je(t,l){if(t&1&&(r(0,"a",34),C(1,"p-button",36),c()),t&2){let e=o(2).$implicit,i=o(2);_("routerLink",v(1,L,i.viewRoute,e.id))}}function Ke(t,l){if(t&1&&m(0,He,2,5,"a",34)(1,Je,2,4),t&2){let e=o(3);u(0,e.viewRoute2?0:1)}}function Xe(t,l){if(t&1&&(r(0,"tr",25),M(1,Ze,6,1,"td",19,be),m(3,ze,2,1,"td",19),r(4,"td",19)(5,"div",26),m(6,Ye,2,1)(7,Ke,2,1),c()()()),t&2){let e=o(2);s(),P(e.columns),s(2),u(3,e.ToggelStatus?3:-1),s(3),u(6,e.editRoute?6:-1),s(),u(7,e.viewRoute?7:-1)}}function et(t,l){if(t&1&&(r(0,"tr")(1,"td")(2,"div",37),C(3,"app-no-data-found-banner"),c()()()),t&2){let e=o(2);s(),O("colspan",e.columns.length+2)}}function tt(t,l){if(t&1){let e=w();r(0,"div",5)(1,"div",6)(2,"h2",7),h(3),c(),r(4,"div",8),m(5,Fe,2,1),c()(),r(6,"div",9)(7,"span",10),C(8,"i",11),r(9,"input",12,0),y("input",function(n){x(e);let a=U(12),d=o();return g(d.onGlobalFilter(a,n))}),c()()(),r(11,"p-table",13,1),y("onPage",function(n){x(e);let a=o();return g(a.onPageChange(n))}),m(13,Me,6,1,"ng-template",14)(14,Xe,8,3,"ng-template",15)(15,et,4,1,"ng-template",16),c()()}if(t&2){let e=o();s(3),Z(e.title),s(2),u(5,e.addRoute?5:-1),s(4),_("title","Search "+e.title.toLowerCase())("placeholder","Search "+e.title.toLowerCase().split(" ",2).join(" ")+"..."),s(2),_("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredData)("scrollable",!0)("tableStyle",q(12,Te))}}function it(t,l){t&1&&C(0,"app-loading-data-banner")}var Dt=(()=>{class t{constructor(){this.ngxSpinnerService=T(X),this.messageService=T($),this.genericDataService=T(me),this.cdRef=T(Y),this.data=[],this.columns=[],this.entityType="",this.title="Data Control",this.addRoute="",this.addRoute2="",this.editRoute="",this.editRoute2="",this.viewRoute="",this.viewRoute2="",this.choicesRoute="",this.choicesRoute2="",this.rowsPerPage=10,this.categoryOptions=[],this.ToggelStatus=!0,this.getData=!1,this.needCall=!1,this.filteredData=[],this.totalRecords=0,this.isLoading=!0,this.selectedStatus=null,this.selectedNeedCall=null,this.selectedCategory=null,this.selectOptions=[{label:"Active",value:"1"},{label:"Inactive",value:"0"}],this.needCallOptions=[{label:"Yes",value:"yes"},{label:"No",value:"no"}],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.searchValue=""}ngOnInit(){this.fetchData()}ngOnChanges(e){e.data&&!this.getData&&this.applyFilters()}fetchData(){this.isLoading=!0,this.getData?this.genericDataService.getAll(this.entityType).subscribe({next:e=>{this.data=e.data.map(i=>V(D({},i),{active_status:this.normalizeActiveStatus(i.active_status)})),this.applyFilters(),this.isLoading=!1},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:`Failed to load ${this.title.toLowerCase()}`}),this.isLoading=!1}}):this.isLoading=!1}normalizeActiveStatus(e){return typeof e=="boolean"?e:typeof e=="string"?e==="1"||e.toLowerCase()==="true":e===1}applyFilters(){let e=[...this.data];if(this.selectedCategory){let i=this.selectedCategory;this.entityType==="build-countries"?e=e.filter(n=>n.build_type_id?.toString()===i||n.build_type&&n.build_type.id?.toString()===i):e=e.filter(n=>n.category_id?.toString()===i||n.category&&n.category.id?.toString()===i)}if(this.selectedStatus!==null&&this.selectedStatus!==""){let i=this.selectedStatus==="1";e=e.filter(n=>n.active_status===i)}if(this.selectedNeedCall!==null&&this.selectedNeedCall!==""&&(e=e.filter(i=>{let n=i.need_call,a=this.selectedNeedCall?.toLowerCase();return typeof n=="boolean"?a==="yes"?n:!n:n?.toString().toLowerCase()===a})),this.searchValue){let i=this.searchValue.toLowerCase();e=e.filter(n=>{let a=this.columns.some(p=>(n[p.field]?.toString().toLowerCase()||"").includes(i)),d=n.category&&(n.category.en_title?.toLowerCase().includes(i)||n.category.ar_title?.toLowerCase().includes(i));return a||d})}this.sortField&&e.sort((i,n)=>this.compareValues(i,n,this.sortField,this.sortOrder)),this.filteredData=e,this.totalRecords=e.length,this.cdRef.detectChanges()}onGlobalFilter(e,i){this.searchValue=i.target.value,this.applyFilters()}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}compareValues(e,i,n,a){let d=e[n],p=i[n];return n==="id"?(d=Number(d),p=Number(p)):(n.includes("date")||n==="created_at"||n==="updated_at")&&(d=new Date(d),p=new Date(p)),d==null?a*-1:p==null?a*1:(d<p?-1:d>p?1:0)*a}onSort(e){let i=e.field,n=e.order;this.filteredData.sort((a,d)=>{let p,f;return i==="id"?(p=Number(a.id),f=Number(d.id)):i==="en_name"?(p=a.en_name,f=d.en_name):i==="ar_name"?(p=a.ar_name,f=d.ar_name):i==="active_status"?(p=a.active_status,f=d.active_status):(p=a[i],f=d[i]),p<f?n===-1?-1:1:p>f?n===-1?1:-1:0})}onPageChange(e){this.currentPage=e.page+1}toggleStatus(e){this.ngxSpinnerService.show("actionsLoader"),this.messageService.clear(),(e.active_status?this.genericDataService.disable(this.entityType,e.id):this.genericDataService.enable(this.entityType,e.id)).subscribe({next:n=>{let a=this.data.findIndex(d=>d.id===e.id);a!==-1&&(this.data[a]=V(D({},this.data[a]),{active_status:this.normalizeActiveStatus(n.data.active_status)})),this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:n.message}),this.ngxSpinnerService.hide("actionsLoader"),this.cdRef.detectChanges()},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:`Failed to update ${this.title.toLowerCase()} status`}),this.ngxSpinnerService.hide("actionsLoader"),this.cdRef.detectChanges()}})}getPagination(){let e=this.data.length;return[10,25,50,100,e].filter(i=>i<=e)}runSpinner(){this.ngxSpinnerService.show("actionsLoader")}truncateText(e,i=50){return e?.length>i?e.substring(0,i)+"...":e}formatDate(e){return e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):"N/A"}getImageUrl(e){return`${K}${e}`}onCategoryFilterChange(e){this.selectedCategory=e,this.applyFilters()}onNeedCallFilterChange(e){this.selectedNeedCall=e,this.applyFilters()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=k({type:t,selectors:[["app-generic-table"]],viewQuery:function(i,n){if(i&1&&B(we,5),i&2){let a;W(a=j())&&(n.dt=a.first)}},inputs:{data:"data",columns:"columns",entityType:"entityType",title:"title",addRoute:"addRoute",addRoute2:"addRoute2",editRoute:"editRoute",editRoute2:"editRoute2",viewRoute:"viewRoute",viewRoute2:"viewRoute2",choicesRoute:"choicesRoute",choicesRoute2:"choicesRoute2",rowsPerPage:"rowsPerPage",categoryOptions:"categoryOptions",ToggelStatus:"ToggelStatus",getData:"getData",needCall:"needCall"},standalone:!0,features:[z([$]),A,Q],decls:3,vars:1,consts:[["search",""],["dt",""],["categoryDropdown",""],["needCallDropdown",""],["statusDropdown",""],[1,"card","overflow-x-auto"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center","mb-3","gap-2"],[1,"text-xl","md:text-2xl","font-semibold","m-0"],[1,"flex","flex-column","md:flex-row","gap-2","w-full","md:w-auto"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right","w-full","md:w-auto"],[1,"pi","pi-search"],["type","text","pInputText","",1,"mb-0","w-full","md:!w-[188px]","ps-1","block",3,"input","title","placeholder"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","responsiveLayout","scroll","scrollDirection","both",3,"onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","scrollable","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"w-full","md:w-auto",3,"routerLink"],["icon","pi pi-plus",1,"btn-main","text-white","w-full","md:w-auto",3,"label"],[1,"text-center"],[1,"text-center",3,"pSortableColumn"],[3,"field"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Category",1,"mx-auto",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Need Call",1,"mx-auto",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Status",1,"mx-auto",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],[1,"bg-[#CBE9F7]","hover:bg-[#a4c6d6]"],[1,"flex","justify-center","gap-2"],[1,"w-16","h-16","mx-auto"],["appImageLoader","",1,"w-full","h-full","object-cover",3,"src","alt"],["target","_blank",1,"!text-main-500","hover:underline",3,"href"],[3,"routerLink","title"],["icon","pi pi-list",1,"p-button-text","p-button-sm"],[3,"title"],[3,"onChange","ngModel"],[3,"routerLink"],["icon","pi pi-pencil",1,"p-button-text","p-button-sm"],["icon","pi pi-eye",1,"p-button-text","p-button-sm"],[1,"h-48","flex","justify-center","items-center","flex-col"]],template:function(i,n){i&1&&(C(0,"p-toast"),m(1,tt,16,13,"div",5)(2,it,1,0)),i&2&&(s(),u(1,n.isLoading?2:1))},dependencies:[le,ae,te,pe,de,ce,re,ge,ue,Ce,xe,_e,se,J,he,fe,H,oe,ie,ne,ee,ye],encapsulation:2})}}return t})();export{Dt as a};
