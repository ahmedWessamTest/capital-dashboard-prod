import{a as R}from"./chunk-N32SSZ7H.js";import{a as O}from"./chunk-DCM55A5P.js";import{a as Q,b as U,c as X,d as Y}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as et}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as J,e as K}from"./chunk-WDDFHKIH.js";import{a as G,b as Z}from"./chunk-NZNLV7ZF.js";import"./chunk-AGVKSH7H.js";import{e as N,j as k,p as j}from"./chunk-V2NMUT4R.js";import{a as tt}from"./chunk-2O7EOZOI.js";import{a as V}from"./chunk-KEBJO4LJ.js";import{d as q,e as H}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{e as W,f as $}from"./chunk-PXM2JOVS.js";import{C as z,x}from"./chunk-27E65EIB.js";import{b as M,d as P,e as I}from"./chunk-67M3DXMG.js";import{n as L}from"./chunk-FYJ5Y7AH.js";import{$a as w,Ab as d,Kb as c,Lb as S,Ob as A,Pb as F,Qa as l,Qb as T,Rb as B,Sb as D,Ub as E,Y as p,ba as b,fb as v,hb as h,ka as m,la as u,mb as y,qb as r,rb as a,sb as s,wb as g,zb as f}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var it=n=>["/dashboard/menu/car-brands/edit",n];function nt(n,_){if(n&1){let t=g();r(0,"tr")(1,"th",14),c(2," ID "),s(3,"p-sortIcon",15),a(),r(4,"th",16),c(5," English Title "),s(6,"p-sortIcon",17),a(),r(7,"th",18),c(8," Arabic Title "),s(9,"p-sortIcon",19),a(),r(10,"th",20)(11,"p-dropdown",21),T("ngModelChange",function(i){m(t);let o=d(2);return F(o.activeFilters.status,i)||(o.activeFilters.status=i),u(i)}),f("onChange",function(i){m(t);let o=d(2);return u(o.onFilterChange("status",i.value))}),a()(),r(12,"th",20),c(13,"Actions"),a()()}if(n&2){let t=d(2);l(11),h("options",t.statusOptions),A("ngModel",t.activeFilters.status),h("showClear",!0)("autoZIndex",!0)}}function rt(n,_){if(n&1){let t=g();r(0,"tr")(1,"td",20),c(2),a(),r(3,"td",20),c(4),a(),r(5,"td",20),c(6),a(),r(7,"td",20)(8,"p-inputSwitch",22),f("onChange",function(){let i=m(t).$implicit,o=d(2);return u(o.toggleStatus(i))}),a()(),r(9,"td",20),s(10,"p-button",23),a()()}if(n&2){let t=_.$implicit,e=d(2);l(2),S(t.id),l(2),S(t.en_title),l(2),S(t.ar_title),l(2),h("ngModel",e.normalizeActiveStatus.normalizeActiveStatus(t.active_status)),l(2),h("routerLink",E(5,it,t.id))}}function at(n,_){n&1&&(r(0,"tr")(1,"td",24),s(2,"app-no-data-found-banner"),a()())}function ot(n,_){if(n&1){let t=g();r(0,"div",2)(1,"div",3)(2,"h2",4),c(3,"Car Brands Control"),a(),s(4,"p-button",5),a(),r(5,"div",6)(6,"span",7),s(7,"i",8),r(8,"input",9,0),f("input",function(i){m(t);let o=d();return u(o.onGlobalFilter(i))}),a()()(),r(10,"p-table",10,1),f("onSort",function(i){m(t);let o=d();return u(o.onSort(i))}),v(12,nt,14,4,"ng-template",11)(13,rt,11,7,"ng-template",12)(14,at,3,0,"ng-template",13),a()()}if(n&2){let t=d();l(10),h("paginator",!0)("rows",t.rowsPerPage)("totalRecords",t.totalRecords)("rowsPerPageOptions",t.getPagination())("showCurrentPageReport",!0)("value",t.filteredData)}}function st(n,_){n&1&&s(0,"app-loading-data-banner")}var Mt=(()=>{class n{constructor(){this.combinedData=[],this.filteredData=[],this.carTypes=[],this.isLoading=w(!1),this.typeOptions=[],this.statusOptions=[{label:"Active",value:"true"},{label:"Inactive",value:"false"}],this.activeFilters={type:null,status:null},this.totalRecords=0,this.rowsPerPage=10,this.currentPage=1,this.searchTerm="",this.carBrandsService=p(R),this.normalizeActiveStatus=p(O),this.spinner=p(V),this.messageService=p(x),this.router=p(P),this.route=p(M)}ngOnInit(){this.isLoading.set(!0),this.route.data.subscribe({next:({data:t})=>{this.combinedData=t.combinedData,this.carTypes=t.carTypes,this.filteredData=[...this.combinedData],this.totalRecords=this.combinedData.length,this.initFilterOptions(),this.spinner.hide(),this.isLoading.set(!1)},error:()=>{this.showError("Failed to load data"),this.spinner.hide(),this.isLoading.set(!1)}}),this.spinner.hide("actionsLoader")}initFilterOptions(){this.typeOptions=this.carTypes.map(t=>({label:t.en_title,value:t.id}))}applyFilters(){this.filteredData=this.combinedData.filter(t=>this.matchesFilter(t,"car_type_id",this.activeFilters.type)&&this.matchesFilter(t,"active_status",this.activeFilters.status)&&this.matchesSearch(t)),this.totalRecords=this.filteredData.length}matchesFilter(t,e,i){return i?t[e]?.toString()===i.toString():!0}matchesSearch(t){return this.searchTerm?[t.id.toString(),t.en_title,t.ar_title,t.car_type_title,this.normalizeActiveStatus.normalizeActiveStatus(t.active_status)?"active":"inactive"].some(i=>i.toLowerCase().includes(this.searchTerm.toLowerCase())):!0}onGlobalFilter(t){this.searchTerm=t.target.value,this.applyFilters()}onFilterChange(t,e){this.activeFilters[t]=e,this.applyFilters()}toggleStatus(t){this.spinner.show("actionsLoader");let e=!this.normalizeActiveStatus.normalizeActiveStatus(t.active_status);(e?this.carBrandsService.enable(t.id):this.carBrandsService.disable(t.id)).subscribe({next:()=>{t.active_status=String(e),this.applyFilters(),this.showSuccess(`Car brand ${e?"enabled":"disabled"} successfully`),this.spinner.hide("actionsLoader")},error:()=>{this.showError("Failed to update car brand status"),this.spinner.hide("actionsLoader")}})}showSuccess(t){this.messageService.add({severity:"success",summary:"Success",detail:t})}showError(t){this.messageService.add({severity:"error",summary:"Error",detail:t})}getPagination(){return[10,25,50,100]}onSort(t){this.filteredData.sort((e,i)=>{let o=e[t.field],C=i[t.field];return t.field==="active_status"&&(o=this.normalizeActiveStatus.normalizeActiveStatus(o)?"true":"false",C=this.normalizeActiveStatus.normalizeActiveStatus(C)?"true":"false"),o==null?1:C==null?-1:(o<C?-1:1)*(t.order===1?1:-1)})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=b({type:n,selectors:[["app-all-car-brands"]],standalone:!0,features:[B([x]),D],decls:3,vars:1,consts:[["search",""],["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],["routerLink","/dashboard/menu/car-brands/add","label","Add Car Brand","icon","pi pi-plus",1,"btn-main","text-white"],[1,"mb-3","flex","justify-content-end"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search car brands...",1,"mb-0",3,"input"],["responsiveLayout","scroll",3,"onSort","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","en_title",1,"text-center"],["field","en_title"],["pSortableColumn","ar_title",1,"text-center"],["field","ar_title"],[1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Status",3,"ngModelChange","onChange","options","ngModel","showClear","autoZIndex"],[3,"onChange","ngModel"],["icon","pi pi-pencil",1,"p-button-text",3,"routerLink"],["colspan","6"]],template:function(e,i){e&1&&(s(0,"p-toast"),v(1,ot,15,6,"div",2)(2,st,1,0)),e&2&&(l(),y(1,i.combinedData.length>0?1:2))},dependencies:[L,$,W,z,K,J,j,N,k,Z,G,Y,Q,U,X,H,q,I,tt,et]})}}return n})();export{Mt as AllCarBrandsComponent};
