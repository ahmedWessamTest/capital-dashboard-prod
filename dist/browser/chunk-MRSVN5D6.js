import{a as H}from"./chunk-DIHUSGI2.js";import{a as le,b as re,c as se,d as pe}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as ce}from"./chunk-Y6SZKX5H.js";import{b as ie}from"./chunk-4WY6IZPL.js";import{d as oe,e as ae}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{e as K,j as X,p as Y}from"./chunk-V2NMUT4R.js";import{a as de}from"./chunk-2O7EOZOI.js";import{a as z,c as G}from"./chunk-KEBJO4LJ.js";import{d as te,e as ne}from"./chunk-PEYIU4ER.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as ee}from"./chunk-PXM2JOVS.js";import{C as U,x as M}from"./chunk-27E65EIB.js";import{b as Q,e as W}from"./chunk-67M3DXMG.js";import{h as q,n as B}from"./chunk-FYJ5Y7AH.js";import{$a as F,Ab as _,Gb as L,Hb as V,Ib as j,Jb as J,Kb as p,Lb as u,Ob as D,Pb as R,Qa as r,Qb as k,Ra as E,Rb as N,Sb as $,Tb as w,Ub as y,Y as S,ba as O,fb as x,hb as g,ka as h,kb as I,la as f,lb as C,mb as A,mc as Z,qb as n,rb as l,sb as c,wb as v,zb as b}from"./chunk-PSXZOWGB.js";import{a as P,b as T}from"./chunk-PSFXZ2QL.js";var ue=["dt"],_e=()=>({"min-width":"80rem"}),ge=t=>["/dashboard/menu/jop-claims/comments",t],Ce=()=>({width:"100%"}),he=t=>["/dashboard/menu/jop-claims/view-jop-claim",t];function fe(t,m){t&1&&c(0,"app-loading-data-banner")}function xe(t,m){if(t&1&&(n(0,"div",34),c(1,"i",35),n(2,"span"),p(3),l()()),t&2){let e=m.$implicit;r(),C(e.icon+" "+e.color),r(),C(e.color),r(),u(e.label)}}function be(t,m){if(t&1&&(n(0,"div",34),c(1,"i",35),n(2,"span"),p(3),l()()),t&2){let e=m.$implicit;r(),C(e.icon+" "+e.color),r(),C(e.color),r(),u(e.label)}}function Se(t,m){if(t&1&&(n(0,"span"),p(1),l()),t&2){let e=m.$implicit;r(),u(e.label)}}function ve(t,m){if(t&1&&(n(0,"span"),p(1),l()),t&2){let e=m.$implicit;r(),u(e.label)}}function we(t,m){if(t&1){let e=v();n(0,"tr",13)(1,"th",14),p(2," ID "),c(3,"p-sortIcon",15),l(),n(4,"th",16),p(5," Name "),c(6,"p-sortIcon",17),l(),n(7,"th",18),p(8," Email "),c(9,"p-sortIcon",19),l(),n(10,"th",20),p(11," Phone "),c(12,"p-sortIcon",21),l(),n(13,"th",22),p(14," Professional Title "),c(15,"p-sortIcon",23),l(),n(16,"th",24),p(17," Claim Number "),c(18,"p-sortIcon",25),l(),n(19,"th",26),p(20," Created "),c(21,"p-sortIcon",27),l(),n(22,"th",13),p(23,"Comments"),l(),n(24,"th",28)(25,"p-dropdown",29),b("onChange",function(o){h(e);let a=_(2);return f(a.onFilterChange(o.value))}),x(26,xe,4,5,"ng-template",30)(27,be,4,5,"ng-template",31),l()(),n(28,"th",32)(29,"p-dropdown",33),b("onChange",function(o){h(e);let a=_(2);return f(a.onTypeFilterChange(o.value))}),x(30,Se,2,1,"ng-template",30)(31,ve,2,1,"ng-template",31),l()(),n(32,"th",13),p(33,"Actions"),l()()}if(t&2){let e=_(2);r(25),g("options",e.selectOptions)("showClear",!0)("autoZIndex",!0),r(4),g("options",e.typeOptions)("showClear",!0)("autoZIndex",!0)}}function ye(t,m){if(t&1&&(n(0,"div",34),c(1,"i",35),n(2,"span"),p(3),l()()),t&2){let e=m.$implicit;r(),C(e.icon+" "+e.color),r(),C(e.color),r(),u(e.label)}}function Me(t,m){if(t&1&&(n(0,"div",34),c(1,"i",35),n(2,"span"),p(3),l()()),t&2){let e=m.$implicit;r(),C(e.icon+" "+e.color),r(),C(e.color),r(),u(e.label)}}function Pe(t,m){if(t&1){let e=v();n(0,"tr",13)(1,"td"),p(2),l(),n(3,"td"),p(4),l(),n(5,"td"),p(6),l(),n(7,"td"),p(8),l(),n(9,"td"),p(10),l(),n(11,"td"),p(12),l(),n(13,"td"),p(14),l(),n(15,"td")(16,"a",36),c(17,"i",37),l()(),n(18,"td",38)(19,"p-dropdown",39),k("ngModelChange",function(o){let a=h(e).$implicit;return R(a.status,o)||(a.status=o),f(o)}),b("onChange",function(o){let a=h(e).$implicit,d=_(2);return f(d.updateClaimStatus(a,o.value))}),x(20,ye,4,5,"ng-template",30)(21,Me,4,5,"ng-template",31),l()(),n(22,"td"),p(23),l(),n(24,"td")(25,"div",40)(26,"a",36),c(27,"i",41),l()()()()}if(t&2){let e=m.$implicit,i=_(2);r(2),u(e.id),r(2),u(e.name),r(2),u(e.email),r(2),u(e.phone),r(2),u(e.jop_title),r(2),u(e.claim_number),r(2),u(i.formatDate(e.created_at)),r(2),g("routerLink",y(17,ge,e.id)),r(2),g("ngClass",i.getStatusClass(e.status)),r(),I(w(19,Ce)),g("options",i.getAvailableStatusOptions(e.status)),D("ngModel",e.status),g("autoZIndex",!0)("appendTo","body"),r(4),u(i.getClaimType(e)),r(3),g("routerLink",y(20,he,e.id))}}function Te(t,m){t&1&&(n(0,"tr",13)(1,"td",42),c(2,"app-no-data-found-banner"),l()())}function Oe(t,m){if(t&1){let e=v();n(0,"div",1)(1,"div",2)(2,"h2",3),p(3,"Professional Claims"),l()(),n(4,"div",4)(5,"span",5),c(6,"i",6),n(7,"input",7),b("input",function(o){h(e);let a=J(10),d=_();return f(d.onGlobalFilter(a,o))}),l()()(),n(8,"div",8)(9,"p-table",9,0),b("onSort",function(o){h(e);let a=_();return f(a.onSort(o))})("onPage",function(o){h(e);let a=_();return f(a.onPageChange(o))}),x(11,we,34,6,"ng-template",10)(12,Pe,28,22,"ng-template",11)(13,Te,3,0,"ng-template",12),l()()()}if(t&2){let e=_();r(9),g("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredClaims)("tableStyle",w(8,_e))("sortMode","multiple")}}var Xe=(()=>{class t{ngOnInit(){this.initDropDownFilter(),this.initTypeFilter(),this.isLoading.set(!0),console.log(this.route.snapshot.data.data),this.isLoading.set(!1),this.claims=this.route.snapshot.data.data?.data||[],this.applyFilters(),this.ngxSpinnerService.hide("actionsLoader")}ngAfterViewInit(){console.log("Table reference:",this.dt)}constructor(e){this.cdRef=e,this.ngxSpinnerService=S(z),this.messageService=S(M),this.jobClaimsService=S(H),this.route=S(Q),this.claims=[],this.isLoading=F(!1),this.filteredClaims=[],this.totalRecords=0,this.rowsPerPage=10,this.selectedStatus=null,this.selectedType=null,this.statusSteps=["requested","pending","confirmed","canceled"],this.sortField=null,this.sortOrder=1,this.currentPage=1,this.selectOptions=[],this.typeOptions=[]}initDropDownFilter(){this.selectOptions=[{label:"Requested",value:"requested",icon:"pi pi-inbox",color:"text-blue-600"},{label:"Pending",value:"pending",icon:"pi pi-clock",color:"text-yellow-600"},{label:"Confirmed",value:"confirmed",icon:"pi pi-check-circle",color:"text-green-600"},{label:"Canceled",value:"canceled",icon:"pi pi-times-circle",color:"text-red-600"}]}initTypeFilter(){this.typeOptions=[{label:"Manual",value:"manual"},{label:"Ordinary",value:"ordinary"}]}getStatusClass(e){switch(e){case"confirmed":return"bg-green-200 text-green-800";case"canceled":return"bg-red-200 text-red-800";case"pending":return"bg-yellow-200 text-yellow-800";case"requested":return"bg-blue-200 text-blue-800";default:return""}}getClaimType(e){return e.jop_insurance_id?"Ordinary":"Manual"}getAvailableStatusOptions(e){let i=this.statusSteps.indexOf(e);return this.selectOptions.filter(o=>!(e==="confirmed"&&o.value==="canceled")).map((o,a)=>T(P({},o),{disabled:a<i}))}applyFilters(){let e=[...this.claims];this.selectedStatus!==null&&(e=e.filter(i=>i.status===this.selectedStatus)),this.selectedType!==null&&(e=e.filter(i=>this.selectedType==="manual"?i.jop_insurance_id===null:i.jop_insurance_id!==null)),this.sortField&&e.sort((i,o)=>this.compareValues(i,o,this.sortField,this.sortOrder)),this.filteredClaims=e,this.totalRecords=e.length}onGlobalFilter(e,i){let a=i.target.value.toLowerCase(),d=[...this.claims];this.selectedStatus!==null&&(d=d.filter(s=>s.status===this.selectedStatus)),this.selectedType!==null&&(d=d.filter(s=>this.selectedType==="manual"?s.jop_insurance_id===null:s.jop_insurance_id!==null)),a&&(d=d.filter(s=>s.id.toString().includes(a)||s.name.toLowerCase().includes(a)||s.email&&s.email.toLowerCase().includes(a)||s.phone&&s.phone.includes(a)||s.status.toLowerCase().includes(a)||s.job_title&&s.job_title.toLowerCase().includes(a)||s.company_name&&s.company_name.toLowerCase().includes(a)||this.getClaimType(s).toLowerCase().includes(a))),this.sortField&&d.sort((s,me)=>this.compareValues(s,me,this.sortField,this.sortOrder)),this.filteredClaims=d,this.totalRecords=d.length}compareValues(e,i,o,a){if(!o)return 0;let d=e[o],s=i[o];return o==="id"?(d=Number(d),s=Number(s)):o==="created_at"||o==="updated_at"?(d=new Date(d),s=new Date(s)):o==="type"&&(d=this.getClaimType(e),s=this.getClaimType(i)),d==null?a*-1:s==null?a*1:d<s?a*-1:d>s?a*1:0}onFilterChange(e){this.selectedStatus=e,this.applyFilters()}onTypeFilterChange(e){this.selectedType=e,this.applyFilters()}onSort(e){this.sortField=e.field,this.sortOrder=e.order,this.applyFilters()}onPageChange(e){this.currentPage=e.page+1}updateClaimStatus(e,i){this.ngxSpinnerService.show("actionsLoader");let o=new FormData;o.append("status",i),this.jobClaimsService.update(e.id,o).subscribe({next:a=>{e.status=a.data.status,this.applyFilters(),this.messageService.add({severity:"success",summary:"Updated",detail:a.message}),this.ngxSpinnerService.hide("actionsLoader")},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update claim status"}),this.ngxSpinnerService.hide("actionsLoader")}})}getPagination(){let e=this.filteredClaims.length;return[10,25,50,100,e].filter(i=>i<=e)}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"})}static{this.\u0275fac=function(i){return new(i||t)(E(Z))}}static{this.\u0275cmp=O({type:t,selectors:[["app-all-jop-claims"]],viewQuery:function(i,o){if(i&1&&L(ue,5),i&2){let a;V(a=j())&&(o.dt=a.first)}},standalone:!0,features:[N([M]),$],decls:3,vars:1,consts:[["dt",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-content-end","gap-3"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search claims...",3,"input"],[1,"overflow-x-auto"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onSort","onPage","paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value","tableStyle","sortMode"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],["pSortableColumn","id",1,"text-center"],["field","id"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","email",1,"text-center"],["field","email"],["pSortableColumn","phone",1,"text-center"],["field","phone"],["pSortableColumn","job_title",1,"text-center"],["field","job_title"],["pSortableColumn","company_name",1,"text-center"],["field","claim_number"],["pSortableColumn","created_at",1,"text-center"],["field","created_at"],["pSortableColumn","status",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Status",3,"onChange","options","showClear","autoZIndex"],["pTemplate","selectedItem"],["pTemplate","item"],["pSortableColumn","type",1,"text-center"],["optionLabel","label","optionValue","value","placeholder","Filter by Type",3,"onChange","options","showClear","autoZIndex"],[1,"flex","items-center","justify-center"],[1,"mr-2"],[3,"routerLink"],[1,"pi","pi-comments"],[3,"ngClass"],["optionLabel","label","optionValue","value","styleClass","status-dropdown",3,"ngModelChange","onChange","options","ngModel","autoZIndex","appendTo"],[1,"flex","gap-2","items-center","justify-center"],[1,"pi","pi-eye"],["colspan","11"]],template:function(i,o){i&1&&(c(0,"p-toast"),x(1,fe,1,0,"app-loading-data-banner")(2,Oe,14,9)),i&2&&(r(),A(1,o.isLoading()?1:2))},dependencies:[ee,U,ae,oe,pe,le,re,se,ne,te,W,de,ce,B,q,Y,K,X,G,ie],styles:[".card[_ngcontent-%COMP%]{padding:1.5rem;border-radius:8px;background:#fff;box-shadow:0 2px 4px #0000001a}  .status-dropdown .p-dropdown{border:none!important;background:transparent!important}  .status-dropdown .p-dropdown .p-dropdown-label{padding:.25rem .5rem;font-size:.875rem}  .p-table .p-table-header-cell{background-color:#f8fafc;border-bottom:2px solid #e5e7eb;font-weight:600;color:#374151}  .p-table .p-table-row:hover{background-color:#f9fafb}  .p-table .p-table-body-cell{padding:.75rem;border-bottom:1px solid #e5e7eb}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{padding-right:2.5rem;border-radius:6px;border:1px solid #d1d5db}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]:focus{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.search-container[_ngcontent-%COMP%]   .p-input-icon-right[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{color:#6b7280}.bg-green-200[_ngcontent-%COMP%]{background-color:#dcfce7}.text-green-800[_ngcontent-%COMP%]{color:#166534}.bg-red-200[_ngcontent-%COMP%]{background-color:#fecaca}.text-red-800[_ngcontent-%COMP%]{color:#991b1b}.bg-yellow-200[_ngcontent-%COMP%]{background-color:#fef3c7}.text-yellow-800[_ngcontent-%COMP%]{color:#92400e}.bg-blue-200[_ngcontent-%COMP%]{background-color:#dbeafe}.text-blue-800[_ngcontent-%COMP%]{color:#1e40af}.pi-eye[_ngcontent-%COMP%], .pi-comments[_ngcontent-%COMP%]{font-size:1.1rem;color:#6b7280;transition:color .2s ease}.pi-eye[_ngcontent-%COMP%]:hover, .pi-comments[_ngcontent-%COMP%]:hover{color:#3b82f6}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}@media (max-width: 1024px){.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:scroll}}"]})}}return t})();export{Xe as AllJopClaimsComponent};
