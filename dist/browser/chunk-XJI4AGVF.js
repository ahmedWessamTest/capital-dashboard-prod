import{a as q}from"./chunk-N32SSZ7H.js";import{a as X}from"./chunk-OOHQEE5L.js";import{e as U}from"./chunk-WDDFHKIH.js";import{a as K,b as Q}from"./chunk-NZNLV7ZF.js";import{a as H,b as J}from"./chunk-AGVKSH7H.js";import{b as D,c as g,e as G,f as j,g as P,k as V,m as R,n as z,o as W,q as Y}from"./chunk-V2NMUT4R.js";import{a as O}from"./chunk-KEBJO4LJ.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as $}from"./chunk-PXM2JOVS.js";import"./chunk-27E65EIB.js";import{b as k,d as N}from"./chunk-67M3DXMG.js";import{h as M,j as A,n as L}from"./chunk-FYJ5Y7AH.js";import{Ab as T,Kb as o,Lb as _,Mb as S,Qa as a,Ra as p,Sb as I,Ub as y,Wb as E,ba as F,fb as v,hb as d,mb as B,qb as i,rb as l,sb as b,zb as w}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var Z=r=>({"ng-invalid ng-dirty":r}),ee=(r,u,e)=>({"bg-green-100 border-green-400 text-green-700":r,"bg-red-100 border-red-400 text-red-700":u,"bg-yellow-100 border-yellow-400 text-yellow-700":e});function te(r,u){if(r&1&&(i(0,"div",3)(1,"strong",20),o(2),l(),i(3,"span",21),o(4),l()()),r&2){let e=T();d("ngClass",E(3,ee,e.message.type==="success",e.message.type==="error",e.message.type==="warn")),a(2),_(e.message.type==="success"?"Success!":e.message.type==="error"?"Error!":"Warning!"),a(2),_(e.message.text)}}function re(r,u){r&1&&(i(0,"small",22),o(1,"English Title is required"),l())}function ie(r,u){r&1&&(i(0,"small",22),o(1,"English Title must be at least 2 characters long"),l())}function ne(r,u){r&1&&(i(0,"small",22),o(1,"Arabic Title is required"),l())}function ae(r,u){r&1&&(i(0,"small",22),o(1,"Arabic Title must be at least 2 characters long"),l())}var Se=(()=>{class r{constructor(e,n,t,m,s,c){this.fb=e,this.route=n,this.router=t,this.ngxSpinnerService=m,this.carBrandsService=s,this.validationService=c,this.carTypes=[],this.dataSubscription=null,this.loading=!1,this.message={text:"",type:""},this.carBrandForm=this.fb.group({en_title:["",[g.required,g.minLength(2)]],ar_title:["",[g.required,g.minLength(2)]],active_status:[!0,g.required]})}ngOnInit(){this.dataSubscription=this.route.data.subscribe({next:e=>{e?.data?.carTypes?(this.carTypes=e.data.carTypes||[],this.ngxSpinnerService.hide("actionsLoader")):(this.message={text:"No car types data received from resolver",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"))},error:e=>{console.error("Failed to load car types data:",e),this.message={text:"Failed to load required car types data",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader")}})}onSubmit(){if(this.carBrandForm.invalid){this.markFormGroupTouched(this.carBrandForm);return}this.loading=!0,this.message={text:"",type:""},this.ngxSpinnerService.show("actionsLoader");let e=this.carBrandForm.value,n=new FormData;n.append("en_title",e.en_title),n.append("ar_title",e.ar_title),n.append("active_status",e.active_status?"1":"0"),this.carBrandsService.getAll().subscribe({next:t=>{if(t.data.map(s=>s.en_title.toLowerCase()).includes(e.en_title.toLowerCase())){this.message={text:`The brand ${e.en_title} already exists.`,type:"warn"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1;return}this.carBrandsService.create(n).subscribe({next:()=>{this.message={text:"Car brand created successfully",type:"success"},this.router.navigate(["/dashboard/menu/car-brands"]),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1,this.clearMessage()},error:s=>{console.error("Error creating car brand:",s),this.message={text:"Failed to create car brand",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1}})},error:t=>{console.error("Error fetching existing car brands:",t),this.message={text:"Failed to check for existing car brands.",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1}})}markFormGroupTouched(e){Object.values(e.controls).forEach(n=>{n.markAsTouched(),n instanceof P&&this.markFormGroupTouched(n)})}clearMessage(){setTimeout(()=>{this.message={text:"",type:""}},5e3)}ngOnDestroy(){this.dataSubscription&&this.dataSubscription.unsubscribe(),this.ngxSpinnerService.hide("actionsLoader")}static{this.\u0275fac=function(n){return new(n||r)(p(W),p(k),p(N),p(O),p(q),p(X))}}static{this.\u0275cmp=F({type:r,selectors:[["app-add-car-brand"]],standalone:!0,features:[I],decls:32,vars:15,consts:[[1,"py-8"],[1,"w-full","mb-4"],[1,"text-xl","font-semibold"],["role","alert",1,"border","px-4","py-3","rounded","relative","mb-4",3,"ngClass"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"flex","flex-col","sm:flex-row","gap-4","mb-6"],[1,"flex-1","w-full"],["for","en_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],[1,"w-full"],["id","en_title","type","text","pInputText","","formControlName","en_title","placeholder","Enter English title",1,"w-full","border","rounded","form-input",3,"ngClass"],[1,"h-6","mt-2"],["class","text-red-500 text-sm mx-4 block",4,"ngIf"],["for","ar_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],["id","ar_title","type","text","pInputText","","formControlName","ar_title","placeholder","Enter Arabic title",1,"w-full","border","rounded","form-input",3,"ngClass"],[1,"flex","gap-2","mx-4","items-center"],[1,"flex","gap-2","items-center"],["id","active_status","formControlName","active_status"],["for","active_status",1,"text-lg"],[1,"flex-1"],["type","submit",1,"px-4","py-2","bg-blue-500","text-white","rounded","text-xl","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"font-bold"],[1,"block","sm:inline","ml-2"],[1,"text-red-500","text-sm","mx-4","block"]],template:function(n,t){if(n&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Add Car Brand"),l()(),v(4,te,5,7,"div",3),i(5,"form",4),w("ngSubmit",function(){return t.onSubmit()}),i(6,"div",5)(7,"div",6)(8,"label",7),o(9,"English Title"),l(),i(10,"div",8),b(11,"input",9),i(12,"div",10),v(13,re,2,0,"small",11)(14,ie,2,0,"small",11),l()()(),i(15,"div",6)(16,"label",12),o(17,"Arabic Title"),l(),i(18,"div",8),b(19,"input",13),i(20,"div",10),v(21,ne,2,0,"small",11)(22,ae,2,0,"small",11),l()()()(),i(23,"div",14)(24,"div")(25,"div",15),b(26,"p-inputSwitch",16),i(27,"label",17),o(28),l()()(),b(29,"div",18),i(30,"button",19),o(31),l()()()()),n&2){let m,s,c,x,h,f,C;a(4),B(4,t.message.text?4:-1),a(),d("formGroup",t.carBrandForm),a(6),d("ngClass",y(11,Z,((m=t.carBrandForm.get("en_title"))==null?null:m.invalid)&&((m=t.carBrandForm.get("en_title"))==null?null:m.touched))),a(2),d("ngIf",((s=t.carBrandForm.get("en_title"))==null?null:s.touched)&&((s=t.carBrandForm.get("en_title"))==null||s.errors==null?null:s.errors.required)),a(),d("ngIf",((c=t.carBrandForm.get("en_title"))==null?null:c.touched)&&((c=t.carBrandForm.get("en_title"))==null||c.errors==null?null:c.errors.minlength)),a(5),d("ngClass",y(13,Z,((x=t.carBrandForm.get("ar_title"))==null?null:x.invalid)&&((x=t.carBrandForm.get("ar_title"))==null?null:x.touched))),a(2),d("ngIf",((h=t.carBrandForm.get("ar_title"))==null?null:h.touched)&&((h=t.carBrandForm.get("ar_title"))==null||h.errors==null?null:h.errors.required)),a(),d("ngIf",((f=t.carBrandForm.get("ar_title"))==null?null:f.touched)&&((f=t.carBrandForm.get("ar_title"))==null||f.errors==null?null:f.errors.minlength)),a(6),S(" ",(C=t.carBrandForm.get("active_status"))!=null&&C.value?"Active":"Inactive"," "),a(2),d("disabled",t.loading||!t.carBrandForm.valid),a(),S(" ",t.loading?"Loading...":"Submit"," ")}},dependencies:[L,M,A,Y,V,D,G,j,R,z,U,J,H,Q,K,$],styles:["[_nghost-%COMP%]     .p-dropdown{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285)}[_nghost-%COMP%]     .p-dropdown .p-dropdown-label{font-size:16px;color:#6b7280;margin-top:1px}[_nghost-%COMP%]     .p-calendar{width:100%}[_nghost-%COMP%]     .p-calendar .p-inputtext{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285);font-size:16px}[_nghost-%COMP%]     .p-calendar .p-inputtext::placeholder{color:#6b7280}[_nghost-%COMP%]     .p-calendar .p-datepicker-trigger{background:transparent;border:none;position:absolute;right:10px;top:50%;transform:translateY(-50%);color:#6b7280}"]})}}return r})();export{Se as AddCarBrandComponent};
