import{a as O}from"./chunk-N32SSZ7H.js";import{a as j}from"./chunk-DCM55A5P.js";import{a as Z}from"./chunk-OOHQEE5L.js";import{e as X}from"./chunk-WDDFHKIH.js";import{a as Q,b as U}from"./chunk-NZNLV7ZF.js";import{a as J,b as K}from"./chunk-AGVKSH7H.js";import{b as q,c as h,e as G,f as P,g as V,k as z,m as R,n as W,o as Y,q as $}from"./chunk-V2NMUT4R.js";import{a as D}from"./chunk-KEBJO4LJ.js";import"./chunk-RJZ3H7D5.js";import"./chunk-5YI4S6VK.js";import{f as H}from"./chunk-PXM2JOVS.js";import"./chunk-27E65EIB.js";import{b as k,d as A}from"./chunk-67M3DXMG.js";import{h as M,j as L,n as N}from"./chunk-FYJ5Y7AH.js";import{Ab as I,Kb as s,Lb as _,Mb as S,Qa as n,Ra as m,Sb as w,Ub as y,Wb as T,ba as C,fb as x,hb as d,mb as F,qb as i,rb as l,sb as v,zb as E}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var ee=r=>({"ng-invalid ng-dirty":r}),te=(r,u,e)=>({"bg-green-100 border-green-400 text-green-700":r,"bg-red-100 border-red-400 text-red-700":u,"bg-yellow-100 border-yellow-400 text-yellow-700":e});function re(r,u){if(r&1&&(i(0,"div",3)(1,"strong",20),s(2),l(),i(3,"span",21),s(4),l()()),r&2){let e=I();d("ngClass",T(3,te,e.message.type==="success",e.message.type==="error",e.message.type==="warn")),n(2),_(e.message.type==="success"?"Success!":e.message.type==="error"?"Error!":"Warning!"),n(2),_(e.message.text)}}function ie(r,u){r&1&&(i(0,"small",22),s(1,"English Title is required"),l())}function ae(r,u){r&1&&(i(0,"small",22),s(1,"English Title must be at least 2 characters long"),l())}function ne(r,u){r&1&&(i(0,"small",22),s(1,"Arabic Title is required"),l())}function le(r,u){r&1&&(i(0,"small",22),s(1,"Arabic Title must be at least 2 characters long"),l())}var Be=(()=>{class r{constructor(e,a,t,c,o,p,g){this.fb=e,this.route=a,this.router=t,this.ngxSpinnerService=c,this.carBrandsService=o,this.validationService=p,this.normalizeActiveStatus=g,this.carTypes=[],this.dataSubscription=null,this.loading=!1,this.message={text:"",type:""},this.carBrandId=null,this.carBrandForm=this.fb.group({en_title:["",[h.required,h.minLength(2)]],ar_title:["",[h.required,h.minLength(2)]],active_status:[!0,h.required]})}ngOnInit(){this.dataSubscription=this.route.data.subscribe({next:e=>{e?.data?.carBrand&&e?.data?.carTypes?(this.carTypes=e.data.carTypes||[],this.carBrandId=e.data.carBrand.id,this.carBrandForm.patchValue({en_title:e.data.carBrand.en_title,ar_title:e.data.carBrand.ar_title,active_status:e.data.carBrand.active_status}),this.ngxSpinnerService.hide("actionsLoader")):(this.message={text:"Failed to load car brand or types data",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"))},error:e=>{console.error("Failed to load car brand data:",e),this.message={text:"Failed to load required data",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader")}})}onSubmit(){if(this.carBrandForm.invalid){this.markFormGroupTouched(this.carBrandForm);return}if(!this.carBrandId){this.message={text:"No car brand ID provided",type:"error"},this.clearMessage();return}this.loading=!0,this.message={text:"",type:""},this.ngxSpinnerService.show("actionsLoader");let e=this.carBrandForm.value,a=new FormData;a.append("en_title",e.en_title),a.append("ar_title",e.ar_title),a.append("active_status",e.active_status?"1":"0"),this.carBrandsService.getAll().subscribe({next:t=>{if(t.data.filter(o=>o.id!==this.carBrandId).map(o=>o.en_title.toLowerCase()).includes(e.en_title.toLowerCase())){this.message={text:`The brand ${e.en_title} already exists.`,type:"warn"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1;return}this.carBrandsService.update(this.carBrandId,a).subscribe({next:()=>{this.message={text:"Car brand updated successfully",type:"success"},this.router.navigate(["/dashboard/menu/car-brands"]),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1,this.clearMessage()},error:o=>{console.error("Error updating car brand:",o),this.message={text:"Failed to update car brand",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1}})},error:t=>{console.error("Error fetching existing car brands:",t),this.message={text:"Failed to check for existing car brands.",type:"error"},this.clearMessage(),this.ngxSpinnerService.hide("actionsLoader"),this.loading=!1}})}markFormGroupTouched(e){Object.values(e.controls).forEach(a=>{a.markAsTouched(),a instanceof V&&this.markFormGroupTouched(a)})}clearMessage(){setTimeout(()=>{this.message={text:"",type:""}},5e3)}ngOnDestroy(){this.dataSubscription&&this.dataSubscription.unsubscribe(),this.ngxSpinnerService.hide("actionsLoader")}static{this.\u0275fac=function(a){return new(a||r)(m(Y),m(k),m(A),m(D),m(O),m(Z),m(j))}}static{this.\u0275cmp=C({type:r,selectors:[["app-edit-car-brand"]],standalone:!0,features:[w],decls:32,vars:15,consts:[[1,"py-8"],[1,"w-full","mb-4"],[1,"text-xl","font-semibold"],["role","alert",1,"border","px-4","py-3","rounded","relative","mb-4",3,"ngClass"],[1,"w-full",3,"ngSubmit","formGroup"],[1,"flex","flex-col","sm:flex-row","gap-4","mb-6"],[1,"flex-1","w-full"],["for","en_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],[1,"w-full"],["id","en_title","type","text","pInputText","","formControlName","en_title","placeholder","Enter English title",1,"w-full","border","rounded","form-input",3,"ngClass"],[1,"h-6","mt-2"],["class","text-red-500 text-sm mx-4 block",4,"ngIf"],["for","ar_title",1,"flex","items-center","gap-1","mx-2","mb-2","font-semibold"],["id","ar_title","type","text","pInputText","","formControlName","ar_title","placeholder","Enter Arabic title",1,"w-full","border","rounded","form-input",3,"ngClass"],[1,"flex","gap-2","mx-4","items-center"],[1,"flex","gap-2","items-center"],["id","active_status","formControlName","active_status"],["for","active_status",1,"text-lg"],[1,"flex-1"],["type","submit",1,"px-4","py-2","bg-blue-500","text-white","rounded","text-xl","hover:bg-blue-600","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"font-bold"],[1,"block","sm:inline","ml-2"],[1,"text-red-500","text-sm","mx-4","block"]],template:function(a,t){if(a&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),s(3,"Edit Car Brand"),l()(),x(4,re,5,7,"div",3),i(5,"form",4),E("ngSubmit",function(){return t.onSubmit()}),i(6,"div",5)(7,"div",6)(8,"label",7),s(9,"English Title"),l(),i(10,"div",8),v(11,"input",9),i(12,"div",10),x(13,ie,2,0,"small",11)(14,ae,2,0,"small",11),l()()(),i(15,"div",6)(16,"label",12),s(17,"Arabic Title"),l(),i(18,"div",8),v(19,"input",13),i(20,"div",10),x(21,ne,2,0,"small",11)(22,le,2,0,"small",11),l()()()(),i(23,"div",14)(24,"div")(25,"div",15),v(26,"p-inputSwitch",16),i(27,"label",17),s(28),l()()(),v(29,"div",18),i(30,"button",19),s(31),l()()()()),a&2){let c,o,p,g,f,b,B;n(4),F(4,t.message.text?4:-1),n(),d("formGroup",t.carBrandForm),n(6),d("ngClass",y(11,ee,((c=t.carBrandForm.get("en_title"))==null?null:c.invalid)&&((c=t.carBrandForm.get("en_title"))==null?null:c.touched))),n(2),d("ngIf",((o=t.carBrandForm.get("en_title"))==null?null:o.touched)&&((o=t.carBrandForm.get("en_title"))==null||o.errors==null?null:o.errors.required)),n(),d("ngIf",((p=t.carBrandForm.get("en_title"))==null?null:p.touched)&&((p=t.carBrandForm.get("en_title"))==null||p.errors==null?null:p.errors.minlength)),n(5),d("ngClass",y(13,ee,((g=t.carBrandForm.get("ar_title"))==null?null:g.invalid)&&((g=t.carBrandForm.get("ar_title"))==null?null:g.touched))),n(2),d("ngIf",((f=t.carBrandForm.get("ar_title"))==null?null:f.touched)&&((f=t.carBrandForm.get("ar_title"))==null||f.errors==null?null:f.errors.required)),n(),d("ngIf",((b=t.carBrandForm.get("ar_title"))==null?null:b.touched)&&((b=t.carBrandForm.get("ar_title"))==null||b.errors==null?null:b.errors.minlength)),n(6),S(" ",(B=t.carBrandForm.get("active_status"))!=null&&B.value?"Active":"Inactive"," "),n(2),d("disabled",t.loading||!t.carBrandForm.valid),n(),S(" ",t.loading?"Loading...":"Submit"," ")}},dependencies:[N,M,L,$,z,q,G,P,R,W,X,K,J,U,Q,H],styles:["[_nghost-%COMP%]     .p-dropdown{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285)}[_nghost-%COMP%]     .p-dropdown .p-dropdown-label{font-size:16px;color:#6b7280;margin-top:1px}[_nghost-%COMP%]     .p-calendar{width:100%}[_nghost-%COMP%]     .p-calendar .p-inputtext{width:100%;height:50px;background:#fff;border-radius:12px;padding:0 20px;color:#1f2937;transition:all .2s ease;border:1px solid rgba(0,0,0,.285);font-size:16px}[_nghost-%COMP%]     .p-calendar .p-inputtext::placeholder{color:#6b7280}[_nghost-%COMP%]     .p-calendar .p-datepicker-trigger{background:transparent;border:none;position:absolute;right:10px;top:50%;transform:translateY(-50%);color:#6b7280}"]})}}return r})();export{Be as EditCarBrandComponent};
