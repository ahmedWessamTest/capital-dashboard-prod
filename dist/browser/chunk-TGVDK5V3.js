import{a as z,b as H,c as K,d as U}from"./chunk-2CYVADF6.js";import"./chunk-ULFGH5XU.js";import{a as X}from"./chunk-Y6SZKX5H.js";import"./chunk-4WY6IZPL.js";import{d as J,e as Y}from"./chunk-WDDFHKIH.js";import"./chunk-AGVKSH7H.js";import{p as O,q as Q}from"./chunk-V2NMUT4R.js";import{a as W}from"./chunk-2O7EOZOI.js";import{a as j}from"./chunk-KEBJO4LJ.js";import{d as $,e as q}from"./chunk-PEYIU4ER.js";import"./chunk-5YI4S6VK.js";import{d as k,f as G}from"./chunk-PXM2JOVS.js";import{C as Z,x as b}from"./chunk-27E65EIB.js";import{b as R,d as B}from"./chunk-67M3DXMG.js";import{n as M}from"./chunk-FYJ5Y7AH.js";import{$a as T,Ab as p,Gb as N,Hb as D,Ib as V,Jb as y,Kb as s,Lb as m,Qa as d,Rb as A,Sb as I,Tb as P,Y as x,ba as S,fb as L,hb as v,ka as f,kb as F,la as C,mb as E,qb as l,rb as o,sb as c,wb as w,zb as _}from"./chunk-PSXZOWGB.js";import"./chunk-PSFXZ2QL.js";var ee=["dt"],te=()=>({width:"120px"});function ie(r,g){r&1&&c(0,"app-loading-data-banner")}function ne(r,g){if(r&1){let e=w();l(0,"tr")(1,"th",16),s(2," Name "),c(3,"p-sortIcon",17),o(),l(4,"th",18),s(5," Phone "),c(6,"p-sortIcon",19),o(),l(7,"th",20)(8,"p-dropdown",21,2),_("onChange",function(n){f(e);let i=y(9);return p(2).onFilterLeadTypeChange(n.value),C(i.showClear=!0)}),o()(),l(10,"th",20)(11,"p-dropdown",22,3),_("onChange",function(n){f(e);let i=y(12);return p(2).onFilterCategoryChange(n.value),C(i.showClear=!0)}),o()(),l(13,"th",20)(14,"p-dropdown",23,4),_("onChange",function(n){f(e);let i=y(15);return p(2).onFilterNeedCallChange(n.value),C(i.showClear=!0)}),o()(),l(16,"th",20),s(17,"Category id"),o(),l(18,"th",20),s(19,"Actions"),o()()}if(r&2){let e=p(2);d(8),v("options",e.leadTypeData)("showClear",!0)("autoZIndex",!0),d(3),v("options",e.categoryData)("showClear",!0)("autoZIndex",!0),d(3),F(P(11,te)),v("options",e.needCallOptions)("showClear",!0)("autoZIndex",!0)}}function ae(r,g){if(r&1){let e=w();l(0,"tr")(1,"td",20),s(2),o(),l(3,"td",20),s(4),o(),l(5,"td",20),s(6),o(),l(7,"td",20),s(8),o(),l(9,"td",20),s(10),o(),l(11,"td",20),s(12),o(),l(13,"td",20)(14,"div",24)(15,"button",25),_("click",function(){let n=f(e).$implicit,i=p(2);return C(i.viewLead(n.category_id,n.id))}),o()()()()}if(r&2){let e=g.$implicit;d(2),m(e.name),d(2),m(e.phone),d(2),m(e.lead_type||"individual"),d(2),m(e.category_name),d(2),m(e.need_call),d(2),m(e.category_id)}}function le(r,g){r&1&&(l(0,"tr")(1,"td",26)(2,"div")(3,"div",27),c(4,"app-no-data-found-banner"),o()()()())}function oe(r,g){if(r&1){let e=w();l(0,"div",5)(1,"div",6)(2,"h2",7),s(3,"Leads Control"),o()(),l(4,"div",8)(5,"span",9),c(6,"i",10),l(7,"input",11,0),_("input",function(n){f(e);let i=y(10),a=p();return C(a.onGlobalFilter(i,n))}),o()()(),l(9,"p-table",12,1),L(11,ne,20,12,"ng-template",13)(12,ae,16,6,"ng-template",14)(13,le,5,0,"ng-template",15),o()()}if(r&2){let e=p();d(9),v("paginator",!0)("rows",e.rowsPerPage)("totalRecords",e.totalRecords)("rowsPerPageOptions",e.getPagination())("showCurrentPageReport",!0)("value",e.filteredLeads)}}var Fe=(()=>{class r{constructor(){this.leads=[],this.filteredLeads=[],this.isLoading=T(!1),this.leadTypeData=[{value:"individual",label:"Individual"},{value:"corporate",label:"Corporate"}],this.categoryData=[{value:1,label:"Medical"},{value:2,label:"Motor"},{value:3,label:"Building"},{value:5,label:"Jop"}],this.needCallOptions=[{label:"Yes",value:"yes"},{label:"No",value:"no"}],this.ngxSpinnerService=x(j),this.messageService=x(b),this.route=x(R),this.router=x(B),this.selectedCategory=null,this.selectedNeedCall=null,this.selectedLeadType=null,this.totalRecords=0,this.rowsPerPage=10}ngOnInit(){this.fetchData()}fetchData(){this.ngxSpinnerService.show("actionsLoader"),this.isLoading.set(!0),this.route.data.subscribe({next:e=>{console.log(e),this.leads=e.data?.combinedLeads||[],this.filteredLeads=[...this.leads],this.totalRecords=this.leads.length,this.ngxSpinnerService.hide("actionsLoader"),this.isLoading.set(!1)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load leads"}),this.ngxSpinnerService.hide("actionsLoader"),this.isLoading.set(!1)}})}applyFilters(){let e=[...this.leads];this.selectedCategory&&(e=e.filter(t=>t.category_id===this.selectedCategory)),this.selectedNeedCall!==null&&this.selectedNeedCall!==""&&(e=e.filter(t=>t.need_call?.toLowerCase()===this.selectedNeedCall)),this.selectedLeadType!==null&&this.selectedLeadType!==""&&(e=e.filter(t=>t.lead_type?.toLowerCase()===this.selectedLeadType)),this.filteredLeads=e,this.totalRecords=e.length,this.dt&&(this.dt.first=0)}onGlobalFilter(e,t){let n=t.target.value.toLowerCase(),i=[...this.leads];this.selectedCategory&&(i=i.filter(a=>a.category_id===this.selectedCategory)),this.selectedNeedCall!==null&&this.selectedNeedCall!==""&&(i=i.filter(a=>a.need_call?.toLowerCase()===this.selectedNeedCall)),this.selectedLeadType!==null&&this.selectedLeadType!==""&&(i=i.filter(a=>a.lead_type?.toLowerCase()===this.selectedLeadType)),n&&(i=i.filter(a=>a.id?.toString().includes(n)||!1||a.name?.toLowerCase().includes(n)||!1||a.phone?.toLowerCase().includes(n)||!1||a.category_name?.toLowerCase().includes(n)||!1||a.email?.toLowerCase().includes(n)||!1||a.need_call?.toLowerCase().includes(n)||!1||a.lead_type?.toLowerCase().includes(n)||!1)),this.filteredLeads=i,this.totalRecords=i.length,this.dt&&(this.dt.first=0)}onFilterCategoryChange(e){this.selectedCategory=e,this.applyFilters()}onFilterNeedCallChange(e){this.selectedNeedCall=e,this.applyFilters()}onFilterLeadTypeChange(e){this.selectedLeadType=e,this.applyFilters()}getPagination(){let e=this.filteredLeads.length;return[10,25,50,100,e].filter(t=>t<=e)}onSort(e){let t=e.field,n=e.order;this.filteredLeads.sort((i,a)=>{let u,h;return t==="id"?(u=Number(i.id)||0,h=Number(a.id)||0):t==="name"?(u=i.name||"",h=a.name||""):t==="phone"?(u=i.phone||"",h=a.phone||""):(u=i[t]||"",h=a[t]||""),u<h?n===-1?-1:1:u>h?n===-1?1:-1:0}),this.dt&&(this.dt.first=0)}viewLead(e,t){e===1?this.router.navigate(["/dashboard/menu/leads/view-medical-lead",t]):e===2?this.router.navigate(["/dashboard/menu/leads/view-motor-lead",t]):e===3?this.router.navigate(["/dashboard/menu/leads/view-building-lead",t]):e===5&&this.router.navigate(["/dashboard/menu/leads/view-jop-lead",t])}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=S({type:r,selectors:[["app-a-all-leads"]],viewQuery:function(t,n){if(t&1&&N(ee,5),t&2){let i;D(i=V())&&(n.dt=i.first)}},standalone:!0,features:[A([b]),I],decls:3,vars:1,consts:[["search",""],["dt",""],["leadType",""],["DdCategory",""],["DdNeedCall",""],[1,"card"],[1,"flex","justify-between","items-center","mb-3"],[1,"text-2xl","font-semibold"],[1,"mb-3","flex","justify-end"],[1,"p-input-icon-right"],[1,"pi","pi-search"],["type","text","pInputText","","placeholder","Search leads...",1,"mb-0",3,"input"],["responsiveLayout","scroll",3,"paginator","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","name",1,"text-center"],["field","name"],["pSortableColumn","phone",1,"text-center"],["field","phone"],[1,"text-center"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Lead Type",1,"mx-auto","max-w-[120px]",3,"onChange","options","showClear","autoZIndex"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Category",1,"mx-auto","max-w-[120px]",3,"onChange","options","showClear","autoZIndex"],["styleClass","mx-auto","optionLabel","label","optionValue","value","placeholder","Need Call",1,"mx-auto","max-w-[120px]",3,"onChange","options","showClear","autoZIndex"],[1,"flex","justify-center","items-center"],["pButton","","icon","pi pi-search",3,"click"],["colspan","6"],[1,"h-48","flex","justify-center","items-center","flex-col"]],template:function(t,n){t&1&&(L(0,ie,1,0,"app-loading-data-banner")(1,oe,14,6),c(2,"p-toast")),t&2&&E(0,n.isLoading()?0:1)},dependencies:[G,k,Z,Q,U,z,H,K,O,Y,J,q,$,M,W,X]})}}return r})();export{Fe as AllLeadsComponent};
